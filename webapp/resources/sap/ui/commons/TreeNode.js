/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","./library","sap/ui/core/CustomStyleClassSupport","sap/ui/core/Element","./Tree","sap/ui/core/Configuration"],function(e,t,s,i,o,r){"use strict";var a=t.TreeSelectionMode;var l=i.extend("sap.ui.commons.TreeNode",{metadata:{library:"sap.ui.commons",deprecated:true,properties:{text:{type:"string",group:"Misc",defaultValue:null},expanded:{type:"boolean",group:"Misc",defaultValue:true},hasExpander:{type:"boolean",group:"Misc",defaultValue:false},icon:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},isSelected:{type:"boolean",group:"Misc",defaultValue:false},selectable:{type:"boolean",group:"Misc",defaultValue:true}},defaultAggregation:"nodes",aggregations:{nodes:{type:"sap.ui.commons.TreeNode",multiple:true,singularName:"node"}},associations:{selectedForNodes:{type:"sap.ui.commons.TreeNode",multiple:true,singularName:"selectedForNode",visibility:"hidden"},ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{toggleOpenState:{parameters:{opened:{type:"boolean"}}},selected:{}}}});l.prototype.getSelectedForNodes=function(){return this.getAssociation("selectedForNodes",[])};l.ANIMATION_DURATION=600;s.apply(l.prototype);l.prototype.expand=function(e,t){this.setProperty("expanded",true,true);var s=null;if(!t){s=n.bind(this)}var i=this.$();if(i.hasClass("sapUiTreeNodeCollapsed")){i.toggleClass("sapUiTreeNodeCollapsed");i.toggleClass("sapUiTreeNodeExpanded");i.attr("aria-expanded","true");var o=this.$("children");if(o){if(e){o.show()}else{o.stop(true,true);o.show(l.ANIMATION_DURATION,s)}o.css({display:"block"})}this.fireToggleOpenState({opened:true})}if(e){var r=this._getNodes();for(var a=0;a<r.length;a++){r[a].expand(e,true)}s&&s()}};l.prototype.collapse=function(e,t){this.setProperty("expanded",false,true);var s=null;if(!t){s=p.bind(this)}var i=this.$();if(i.hasClass("sapUiTreeNodeExpanded")){i.toggleClass("sapUiTreeNodeCollapsed");i.toggleClass("sapUiTreeNodeExpanded");i.attr("aria-expanded","false");var o=this.$("children");if(o){if(e){o.hide()}else{o.stop(true,true);o.hide(l.ANIMATION_DURATION,s)}}this.fireToggleOpenState({opened:false})}if(e){var r=this._getNodes();for(var a=0;a<r.length;a++){r[a].collapse(e,true)}s&&s()}};l.prototype.select=function(e){var t=this.getTree();if(t){t.setSelection(this,e)}else{this._select()}};function n(){var e=this.getTree();if(e){e._adjustSelectionOnExpanding(this)}}function p(){var e=this.getTree();if(e){e._adjustSelectionOnCollapsing(this);e._adjustFocus()}}l.prototype._select=function(e){this.setProperty("isSelected",true,true);if(!e){this.fireSelected()}if(this.getDomRef()){this.$().closest(".sapUiTreeNode").addClass("sapUiTreeNodeSelected").attr("aria-selected","true");this.scrollIntoView()}};l.prototype._deselect=function(e){this.setProperty("isSelected",false,true);if(this.getDomRef()){this.$().removeClass("sapUiTreeNodeSelected").removeAttr("aria-selected")}};l.prototype._getNodes=function(){return this.mAggregations.nodes||[]};l.prototype.hasSelectedHiddenChild=function(){var e=this._getNodes();for(var t=0;t<e.length;t++){if(!e[t].isVisible()&&e[t].getIsSelected()||e[t].hasSelectedHiddenChild()){return true}}return false};l.prototype.setIsSelected=function(e){var t=this.getTree();if(!this.getSelectable()){return this}if(e==this.getProperty("isSelected")){return this}if(t){t._setNodeSelection(this,e,true)}else{this.setProperty("isSelected",e,true)}return this};l.prototype.setSelectable=function(e){if(!e&&this.getIsSelected()){this.setIsSelected(false)}this.setProperty("selectable",e);return this};l.prototype.onclick=function(t){var s=t.target,i=this.getTree();if(e(s).is(".sapUiTreeNode")||e(s).is(".sapUiTreeNodeNotSelectable")){if(e(s).is(".sapUiTreeNodeNotSelectable")){s=e(s).closest(".sapUiTreeNode")[0]}if(e(s).hasClass("sapUiTreeNodeExpanded")){this.collapse()}else{this.expand()}i.placeFocus(s);s.focus()}else if(e(s).is(".sapUiTreeNodeContent")||e(s).is(".sapUiTreeIcon")){var r=o.SelectionType.Select;if(i.getSelectionMode()==a.Multi){if(t.shiftKey){r=o.SelectionType.Range}if(t.metaKey||t.ctrlKey){r=o.SelectionType.Toggle}}i.setSelection(this,false,r);s=e(s).closest(".sapUiTreeNode")[0];i.placeFocus(s);s.focus()}};l.prototype.onsapselect=function(e){if(this.getSelectable()){this.getTree().setSelection(this)}else if(this.getExpanded()){this.collapse()}else{this.expand()}};l.prototype.onsapexpand=function(e){this.expand()};l.prototype.onsapcollapse=function(e){this.collapse()};l.prototype.onsapleft=function(e){if(r.getRTL()){this.expand()}else{this.collapse()}e.preventDefault()};l.prototype.onsapright=function(e){if(r.getRTL()){this.collapse()}else{this.expand()}e.preventDefault()};l.prototype.focus=function(){var e=this.getFocusDomRef();if(e){e.setAttribute("tabindex","0");e.focus()}};l.prototype.blur=function(){var e=this.getFocusDomRef();if(e){e.setAttribute("tabindex","-1")}};l.prototype.getTree=function(){var e=this.getParent();while(e instanceof l){e=e.getParent()}return e};l.prototype.hasChildren=function(){var e=this._getNodes();if(e.length){return true}return false};l.prototype.isVisible=function(){var e=this.getParent();while(e instanceof l){if(!e.getExpanded()){return false}e=e.getParent()}return true};l.prototype.scrollIntoView=function(){var e=this.$(),t=this.getTree().$(),s=t.find(".sapUiTreeCont"),i=e[0].offsetTop,o=s.scrollTop(),r=s.height(),a,l=e[0].offsetLeft,n=s.scrollLeft(),p=s.width(),d;if(i>o+r||i<o){a=i-Math.floor(r*.5);a=Math.max(a,0)}if(l>n+p||l<n){d=l-Math.floor(p*.5);d=Math.max(d,0)}if(a!==undefined||d!==undefined){var u={};if(a!==undefined){u.scrollTop=a}if(d!==undefined){u.scrollLeft=d}s.stop(true,true).animate(u)}};l.prototype.getTooltip_AsString=function(){var e;var t=this.getTooltip();if(typeof t==="string"||t instanceof String){e=t}if(!e){e=this.getText()}return e};return l});