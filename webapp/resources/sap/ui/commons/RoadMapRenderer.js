/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/Device","sap/base/security/encodeXML","sap/ui/core/Configuration","sap/ui/thirdparty/jqueryui/jquery-ui-position"],function(e,t,a,i){"use strict";var r={};r.render=function(e,t){t.doBeforeRendering();e.write("<div");e.writeControlData(t);e.addClass("sapUiRoadMap");e.writeClasses();e.writeAttribute("tabindex","0");var a=t.getTooltip_AsString();if(a){e.writeAttributeEscaped("title",a)}e.writeAttribute("style","width:"+(t.getWidth()?t.getWidth():"100%")+";");e.write(">");d(e,t,true);e.write("<ul");e.writeAttribute("id",t.getId()+"-steparea");e.addClass("sapUiRoadMapStepArea");e.writeClasses();if(i.getAccessibility()){e.writeAttribute("role","group");e.writeAttributeEscaped("aria-label",S("RDMP_DEFAULT_TOOLTIP",[]));if(a){e.writeAttributeEscaped("title",a)}}e.write(">");var r=t.getSteps();for(var s=0;s<r.length;s++){var n=r[s];if(n.getSubSteps().length>0){g(e,t,n)}else{l(e,t,n)}}e.write("</ul>");d(e,t,false);e.write("</div>")};r.selectStepWithId=function(e,t){var a=e.getSelectedStep();if(a){s(a).removeClass("sapUiRoadMapSelected")}if(t){s(t).addClass("sapUiRoadMapSelected")}if(i.getAccessibility()){if(a){s(a+"-box").removeAttr("aria-checked")}if(t){s(t+"-box").attr("aria-checked",true)}}};r.selectStep=function(t,a,d,l,n,p){if(!p){r.selectStepWithId(t,a.getId())}if(!d&&a.getSubSteps().length>0){var o=a.getSubSteps();var f=a.$();var u=f.hasClass("sapUiRoadMapExpanded");var v=1;var g=function(){v--;if(v>0){return}if(n){n(!u?"expanded":"collapsed")}r.updateStepArea(t)};var c=function(a,i,r){var d=s(a);if(!e.fx.off&&!l){d.width(i?"0px":t.iStepWidth);var n=s(a+"-label");n.addClass("sapUiRoadMapHidden");if(i){d.toggleClass("sapUiRoadMapHidden")}d.animate({width:i?t.iStepWidth:"0px"},"fast",function(){if(!i){d.toggleClass("sapUiRoadMapHidden")}d.width("");n.removeClass("sapUiRoadMapHidden");if(r){r()}})}else{d.toggleClass("sapUiRoadMapHidden");if(r){r()}}};f.toggleClass("sapUiRoadMapExpanded");if(i.getAccessibility()){var b=f.hasClass("sapUiRoadMapExpanded");a.$("box").attr("aria-expanded",b);a.$("expandend-box").attr("aria-expanded",b)}for(var S=0;S<o.length;S++){if(o[S].getVisible()){v++;c(o[S].getId(),!u,g)}}c(a.getId()+"-expandend",!u,g)}else{if(n){n("selected")}}};r.updateStepArea=function(e){if(e.iStepWidth!=-1){var t=e.$("steparea");var a=e.$("Start");var i=e.$("End");var r=e.$();var s=t.scrollLeft();var d=r.width()-a.outerWidth(true)-i.outerWidth(true);var l=e.getNumberOfVisibleSteps();var n=h(e);if(l<1){l=n}else{l=Math.min(l,n)}var p=Math.floor(d/e.iStepWidth);var o=Math.min(l,p);t.width(o*e.iStepWidth).scrollLeft(s);b(e)}};r.updateScrollArea=function(e,t){r.updateStepArea(e);if(!t){var a=e.$("steparea");var i=C(e,false);if(e.getFirstVisibleStep()){var d=s(e.getFirstVisibleStep());if(d.length){i=w(a,d)}}A(e,i+R()*a.scrollLeft(),true)}};r.isVisibleRef=function(t,a){var i=t.$("steparea");var r=i.children(":visible");for(var s=0;s<r.length;s++){var d=e(r.get(s));if(d.attr("id")==a){var l=w(i,d);return l>=0&&l<i.width()}}return false};r.getFirstVisibleRef=function(t){var a=t.$("steparea");var i=a.children(":visible");for(var r=0;r<i.length;r++){var s=e(i.get(r));if(w(a,s)==0){return s}}return null};r.setStepLabel=function(e,t){var r=t?a(t):"";e.$("label").html(r);e.$("expandend-label").html(r);if(!i.getAccessibility()){return}e.$("box").attr("aria-label",f(e,t));e.$("expandend-box").attr("aria-label",f(e,t))};r.setStepEnabled=function(e,t,a){var r=t.$();var s=t.$("expandend");if(a){r.removeClass("sapUiRoadMapDisabled");s.removeClass("sapUiRoadMapDisabled");if(i.getAccessibility()){t.$("box").removeAttr("aria-disabled");t.$("expandend-box").removeAttr("aria-disabled")}return false}else{var d=e.getSelectedStep()==t.getId();if(d){r.removeClass("sapUiRoadMapSelected")}r.addClass("sapUiRoadMapDisabled");s.addClass("sapUiRoadMapDisabled");if(i.getAccessibility()){var l=t.$("box");l.attr("aria-disabled",true);if(d){l.removeAttr("aria-checked")}t.$("expandend-box").attr("aria-disabled",true)}return d}};r.setStepVisible=function(e,t,a,i){var r=t.$();var s=t.$("expandend");var d=e.getSelectedStep()==t.getId();var l=t.getParent();if(a){if(l.getEnabled()&&l.getVisible()&&l.getExpanded()){if(i){r.removeClass("sapUiRoadMapHidden")}else{r.addClass("sapUiRoadMapHidden")}}}else{if(i){r.removeClass("sapUiRoadMapHidden")}else{r.addClass("sapUiRoadMapHidden")}var n=t.getSubSteps();if(n.length>0&&t.getExpanded()){if(i){s.removeClass("sapUiRoadMapHidden")}else{s.addClass("sapUiRoadMapHidden")}for(var p=0;p<n.length;p++){if(n[p].getVisible()){var o=n[p].$();if(e.getSelectedStep()==n[p].getId()){d=true;o.removeClass("sapUiRoadMapSelected");n[p].$("box").removeAttr("aria-checked")}if(i){o.removeClass("sapUiRoadMapHidden")}else{o.addClass("sapUiRoadMapHidden")}}}}}return d};r.setRoadMapWidth=function(e,t){var a=e.$();a.attr("style","width:"+(t?t:"100%")+";")};r.scrollToNextStep=function(e,t,a){var i=t;if(t=="first"||t=="last"){i=C(e,t=="last")}A(e,i,false,a)};r.addEllipses=function(t){if(!t){return}var i=t.$("label");var r=t.getLabel();var s=r+"";var d=e('<label class="sapUiRoadMapTitle" style="display:none;position:absolute;overflow:visible;font-weight:bold;height:auto">'+s+"</label>");d.width(i.width());e(sap.ui.getCore().getStaticAreaRef()).append(d);var l=false;while(s.length>0&&d.height()>i.height()){s=s.substr(0,s.length-1);d.html(a(s+"..."));l=true}if(l){i.html("<span>"+a(s)+"</span>");i.attr("title",t.getLabel())}else{i.attr("title",n(t))}d.remove()};r.updateStepAria=function(e){if(!i.getAccessibility()){return}var t=e.getParent()instanceof sap.ui.commons.RoadMap;var a=e.getParent()[t?"getSteps":"getSubSteps"]();for(var r=0;r<a.length;r++){var s=u(a[r]);var d=v(a[r]);var l=a[r].$("box");l.attr("aria-posinset",s);l.attr("aria-setsize",d);if(t&&a[r].getSubSteps().length>0){l=a[r].$("expandend-box");l.attr("aria-posinset",s);l.attr("aria-setsize",d)}}};var s=function(t){return e(t?document.getElementById(t):null)};var d=function(e,t,a){var i=a?"Start":"End";e.write("<div");e.writeAttribute("id",t.getId()+"-"+i);e.writeAttribute("tabindex","-1");var r=true;e.addClass(r?"sapUiRoadMap"+i+"Scroll":"sapUiRoadMap"+i+"Fixed");e.addClass("sapUiRoadMapDelim");e.addClass("sapUiRoadMapContent");e.writeClasses();e.write("></div>")};var l=function(e,t,a,i,r,s){e.write("<li");if(s){e.writeAttribute("id",s)}else{e.writeElementData(a)}var d=c(t,a);a.__stepName=d;var l=n(a);e.addClass("sapUiRoadMapContent");e.addClass("sapUiRoadMapStep");if(!a.getVisible()){e.addClass("sapUiRoadMapHidden")}if(a.getEnabled()){if(t.getSelectedStep()==a.getId()){e.addClass("sapUiRoadMapSelected")}}else{e.addClass("sapUiRoadMapDisabled")}if(i){for(var f=0;f<i.length;f++){e.addClass(i[f])}}e.writeClasses();e.write(">");p(e,s?s:a.getId(),1);e.write("<div");e.writeAttribute("id",(s?s:a.getId())+"-box");e.writeAttribute("tabindex","-1");e.addClass("sapUiRoadMapStepBox");e.writeClasses();e.writeAttributeEscaped("title",l);o(e,t,a,r?true:false);e.write("><span>");e.write(d);e.write("</span>");if(r){r(e,t,a)}e.write("</div>");e.write("<label");e.writeAttribute("id",(s?s:a.getId())+"-label");e.addClass("sapUiRoadMapTitle");e.writeAttributeEscaped("title",l);e.writeClasses();e.write(">");var u=a.getLabel();if(u){e.writeEscaped(u)}e.write("</label>");p(e,s?s:a.getId(),2);e.write("</li>")};var n=function(e){var t=e.getTooltip_AsString();if(!t&&!e.getTooltip()&&i.getAccessibility()){t=S("RDMP_DEFAULT_STEP_TOOLTIP",[e.__stepName])}return t||""};var p=function(e,t,a){e.write("<div");e.writeAttribute("id",t+"-add"+a);e.addClass("sapUiRoadMapStepAdd"+a);e.writeClasses();e.write("></div>")};var o=function(e,t,a,r){if(!i.getAccessibility()){return}e.writeAttribute("role","treeitem");if(a.getEnabled()){e.writeAttribute("aria-checked",t.getSelectedStep()==a.getId())}else{e.writeAttribute("aria-disabled",true)}e.writeAttribute("aria-haspopup",r);e.writeAttribute("aria-level",a.getParent()instanceof sap.ui.commons.RoadMap?1:2);e.writeAttribute("aria-posinset",u(a));e.writeAttribute("aria-setsize",v(a));e.writeAttributeEscaped("aria-label",f(a,a.getLabel()));if(!r){return}e.writeAttribute("aria-expanded",a.getExpanded())};var f=function(e,t){var a=e.getParent()instanceof sap.ui.commons.RoadMap&&e.getSubSteps().length>0;var i=t||"";if(e.getEnabled()){i=S(a?"RDMP_ARIA_EXPANDABLE_STEP":"RDMP_ARIA_STANDARD_STEP",[i])}return i};var u=function(e){var t=e.getParent()instanceof sap.ui.commons.RoadMap;var a=e.getParent()[t?"indexOfStep":"indexOfSubStep"](e);var i=0;var r=e.getParent()[t?"getSteps":"getSubSteps"]();for(var s=0;s<a;s++){if(!r[s].getVisible()){i++}}return a+1-i};var v=function(e){var t=e.getParent()instanceof sap.ui.commons.RoadMap;var a=e.getParent()[t?"getSteps":"getSubSteps"]();var i=a.length;for(var r=0;r<a.length;r++){if(!a[r].getVisible()){i--}}return i};var g=function(e,t,a){var i=function(e,t,a,i,r){e.write("<div");e.writeAttribute("id",a+"-ico");e.addClass("sapUiRoadMapStepIco");if(r){e.addClass(r)}e.writeClasses();e.write("></div>")};var r=a.getExpanded();l(e,t,a,r?["sapUiRoadMapExpanded"]:null,function(e,t,a){i(e,t,a.getId(),r?"roundtripstart.gif":"roundtrip.gif")});var s=a.getSubSteps();for(var d=0;d<s.length;d++){var n=["sapUiRoadMapSubStep"];if(!r&&s[d].getVisible()){n.push("sapUiRoadMapHidden")}l(e,t,s[d],n)}n=["sapUiRoadMapExpanded","sapUiRoadMapStepEnd"];if(!r){n.push("sapUiRoadMapHidden")}l(e,t,a,n,function(e,t,a){i(e,t,a.getId()+"-expandend","roundtripend.gif")},a.getId()+"-expandend")};var c=function(e,t){var a=t.getParent();if(a===e){return a.indexOfStep(t)+1}var i=a.indexOfSubStep(t);if(i<26){return String.fromCharCode(97+i)}var r=Math.floor(i/26)-1;var s=i%26;return String.fromCharCode(97+r,97+s)};var b=function(e){var t=R();var a=e.$("steparea");var i=M(a);var r=e.$("Start");r.removeClass("sapUiRoadMapStartScroll").removeClass("sapUiRoadMapStartFixed");r.addClass(t*i>=e.iStepWidth?"sapUiRoadMapStartScroll":"sapUiRoadMapStartFixed");var s=e.$("End");s.removeClass("sapUiRoadMapEndScroll").removeClass("sapUiRoadMapEndFixed");var d=a.get(0).scrollWidth-t*i-a.width()<e.iStepWidth;s.addClass(d?"sapUiRoadMapEndFixed":"sapUiRoadMapEndScroll")};var S=function(e,t){var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.commons");if(a){return a.getText(e,t)}return e};var h=function(e){var t=0;var a=e.getSteps();for(var i=0;i<a.length;i++){if(a[i].getVisible()){t++;if(a[i].getExpanded()){t++;var r=a[i].getSubSteps();for(var s=0;s<r.length;s++){if(r[s].getVisible()){t++}}}}}return t};var w=function(e,t){var a=t.position().left;if(i.getRTL()){a=e.width()-a-t.outerWidth()}return a};var R=function(){return i.getRTL()?-1:1};var M=function(e){if(i.getRTL()&&t.browser.webkit){return-1*(e.get(0).scrollWidth-e.scrollLeft()-e.width())}return e.scrollLeft()};var C=function(e,a){var r=e.$("steparea").get(0).scrollWidth;if(i.getRTL()&&t.browser.webkit){return a?0:-1*r}return a?r:0};var A=function(t,a,i,s){var d=t.$("steparea");d.stop(false,true);if(a=="next"){a=d.scrollLeft()+t.iStepWidth*R()}else if(a=="prev"){a=d.scrollLeft()-t.iStepWidth*R()}else if(a=="keep"){a=d.scrollLeft()}else{a=a*R()}var l=function(){b(t);if(s){var e=r.getFirstVisibleRef(t);s(e.attr("id"))}};if(!e.fx.off&&!i){d.animate({scrollLeft:a},"fast",l)}else{d.scrollLeft(a);l()}};return r},true);