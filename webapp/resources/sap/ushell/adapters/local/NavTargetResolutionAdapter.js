// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/_ClientSideTargetResolution/VirtualInbounds","sap/base/util/ObjectPath","sap/ui/thirdparty/jquery","sap/base/Log","sap/ushell/utils"],function(e,n,i,t,r){"use strict";var s=function(s,o,a){var l=n.create("config.applications",a);var f=e.getInbounds();u(f,l);function u(e,n){e.forEach(function(e){var i=e.semanticObject+"-"+e.action;n[i]=e.resolutionResult})}this.resolveHashFragment=function(e){var n=new i.Deferred,s,o,a,f;if(e&&e.charAt(0)!=="#"){throw new r.Error("Hash fragment expected","sap.ushell.renderers.minimal.Shell")}e=e.substring(1);if(!e&&!l[e]){n.resolve(undefined)}else{t.info("Hash Fragment: "+e);s=e.indexOf("&/");if(s>=0){e=e.slice(0,s)}s=e.indexOf("?");if(s>=0){f=e.slice(s+1);e=e.slice(0,s)}o=l[e];if(o){a={additionalInformation:o.additionalInformation,applicationType:o.applicationType,url:o.url,text:o.text,fullWidth:o.fullWidth};if(f){a.url+=a.url.indexOf("?")<0?"?":"&";a.url+=f}if(o.navigationMode!==undefined){a.navigationMode=o.navigationMode}n.resolve(a)}else{n.reject("Could not resolve link '"+e+"'")}}return n.promise()};this.getSemanticObjectLinks=function(e,n){var r,s=[],o=0,a=new i.Deferred,f;if(!e){setTimeout(function(){a.resolve([])},0)}else{sap.ushell.Container.getServiceAsync("URLParsing").then(function(i){f=i.paramsToString(n);t.info("getSemanticObjectLinks: "+e);for(r in l){if(l.hasOwnProperty(r)&&r.substring(0,r.indexOf("-"))===e){s[o]=l[r];s[o].id=r;s[o].text=s[o].text||s[o].description||"no text";s[o].intent="#"+r;if(f!==""){if(s[o].intent.indexOf("?")!==-1){s[o].intent+="&"+f}else{s[o].intent+="?"+f}}o+=1}}if(s){a.resolve(s)}else{a.reject("Could not get links for  '"+e+"'")}})}return a.promise()};this.isIntentSupported=function(e){var n=new i.Deferred,t={},r=[],s=this;function o(e,n){t[e]={supported:n}}e.forEach(function(e,n){var t=new i.Deferred;r.push(t.promise());s.resolveHashFragment(e).fail(function(n){o(e,false);t.resolve()}).done(function(n){o(e,true);t.resolve()})});if(e.length>0){i.when.apply(i,r).always(function(){n.resolve(t)})}else{n.resolve(t)}return n.promise()}};return s},false);