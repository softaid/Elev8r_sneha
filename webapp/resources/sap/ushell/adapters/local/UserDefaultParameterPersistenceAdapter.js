// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/base/Log"],function(e,r){"use strict";var t=function(e,r,t){this._oConfig=t&&t.config;this._oContainerPromises={}};t.prototype._getPersonalizationService=function(){return sap.ushell.Container.getServiceAsync("Personalization")};t.prototype.saveParameterValue=function(t,n,o){var i=new e.Deferred;if(!(typeof t==="string"&&t.length<=40&&/^[A-Za-z0-9.-_]+$/.exec(t))){r.error('Illegal Parameter Key, less than 40 characters and [A-Za-z0-9.-_]+ :"'+t+'"')}this._getUDContainer(o).done(function(e){e.setItemValue(t,n);e.saveDeferred(50).done(i.resolve.bind(i)).fail(i.reject.bind(i))}).fail(function(e){r.error(e);i.reject(e)});return i.promise()};t.prototype.deleteParameter=function(t,n){var o=new e.Deferred;if(!(typeof t==="string"&&t.length<=40&&/^[A-Za-z0-9.-_]+$/.exec(t))){r.error('Illegal Parameter Key, less than 40 characters and [A-Za-z0-9.-_]+ :"'+t+'"')}this._getUDContainer(n).done(function(e){e.delItem(t);e.save().done(o.resolve.bind(o)).fail(o.reject.bind(o))}).fail(function(e){r.error(e);o.reject(e)});return o.promise()};t.prototype.loadParameterValue=function(t,n){var o=new e.Deferred;this._getUDContainer(n).done(function(e){var r=e.getItemValue(t);if(r){o.resolve(r)}else{o.reject("no value ")}}).fail(function(e){r.error(e);o.reject(e)});return o.promise()};t.prototype.getStoredParameterNames=function(t){var n=new e.Deferred;this._getUDContainer(t).done(function(e){var r=e.getItemKeys();n.resolve(r)}).fail(function(e){r.error(e);n.reject(e)});return n.promise()};t.prototype._getUDContainer=function(r){var t=r.id;if(t!==""){t="."+t}if(!this._oContainerPromises[r.id]){var n=new e.Deferred;this._oContainerPromises[r.id]=n.promise();this._getPersonalizationService().then(function(e){e.getContainer("sap.ushell.UserDefaultParameter"+t,{keyCategory:e.constants.keyCategory.FIXED_KEY,writeFrequency:e.constants.writeFrequency.LOW,clientStorageAllowed:true}).done(n.resolve).fail(n.reject)})}return this._oContainerPromises[r.id]};return t},false);