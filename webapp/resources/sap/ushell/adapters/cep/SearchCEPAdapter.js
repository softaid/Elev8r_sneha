// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/base/util/UriParameters","sap/ui/core/Configuration","sap/ushell/Config"],function(e,t,a,r){"use strict";var i=function(e,t,a){this._oConfig=a&&a.config||{};this._oConfig.searchProvider=this._oConfig.searchProvider||"/navigation/search/api/v1/lookupTargets"};i.prototype.execSearch=function(i){var s=this._oConfig.searchProvider;var n=sap.ushell.Container.getFLPPlatform(true);var o=new t(document.URL);var c=r.last("/core/site/siteId");var u=a.getLanguageTag();if(typeof i==="string"&&i.length>0){s+="?query="+encodeURIComponent(i)}if(typeof c==="string"&&c.length>0){s+=s.indexOf("?")>0?"&":"?";s+="siteId="+encodeURIComponent(c)}if(n==="MYHOME"){s+=s.indexOf("?")>0?"&":"?";s+="genLink=true"}if(e.getLevel()>=e.Level.DEBUG){e.debug("Navigation service search triggered","url: "+s,"sap.ushell.adapters.cep.SearchCEPAdapter::execSearch")}if(o.get("sap-statistics")==="true"||window.localStorage.getItem("sap-ui-statistics")==="X"){s+=s.indexOf("?")>0?"&":"?";s+="sap-statistics=true"}return fetch(s,{method:"GET",headers:{"Content-Type":"application/json; utf-8",Accept:"application/json","Accept-Language":u}}).then(function(t){if(t.ok===false){e.error("Navigation service search adapter failed","error: "+t.status+","+t.statusText+"\nurl: "+s,"sap.ushell.adapters.cep.SearchCEPAdapter::execSearch");return Promise.reject(t.statusText)}return t.json()}).then(function(t){if(e.getLevel()>=e.Level.DEBUG){e.debug("Navigation service search adapter success","url: "+s+"\n\n"+JSON.stringify(t||{},null,2),"sap.ushell.adapters.cep.SearchCEPAdapter::execSearch")}return t})};return i},false);