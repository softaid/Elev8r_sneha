// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/utils","sap/ushell/services/_Personalization/utils","sap/ushell/services/_Personalization/WindowAdapter","sap/ui/thirdparty/jquery"],function(e,t,n,o){"use strict";function i(t,n,o){this._oBackendContainer=o;this._oItemMap=new e.Map;this._sContainerKey=t}function a(e){var t,n=e.getItemKeys();for(t=0;t<n.length;t=t+1){e.delItem(n[t])}}i.prototype.load=function(){var e=new o.Deferred,i,s,r=this;if(n.prototype.data[this._sContainerKey]){this._oItemMap.entries=t.clone(n.prototype.data[this._sContainerKey]);if(this._oBackendContainer){a(this._oBackendContainer);s=this.getItemKeys();for(i=0;i<s.length;i=i+1){this._oBackendContainer.setItemValue(s[i],this._oItemMap.get(s[i]))}}e.resolve()}else if(this._oBackendContainer){this._oBackendContainer.load().done(function(){s=r._oBackendContainer.getItemKeys();for(i=0;i<s.length;i=i+1){r.setItemValue(s[i],r._oBackendContainer.getItemValue(s[i]))}n.prototype.data[r._sContainerKey]=t.clone(r._oItemMap.entries);e.resolve()}).fail(function(t){e.reject(t)})}else{n.prototype.data[this._sContainerKey]={};e.resolve()}return e.promise()};i.prototype.save=function(){var e=new o.Deferred;n.prototype.data[this._sContainerKey]=t.clone(this._oItemMap.entries);if(this._oBackendContainer){this._oBackendContainer.save().done(function(){e.resolve()}).fail(function(t){e.reject(t)})}else{e.resolve()}return e.promise()};i.prototype.getItemKeys=function(){return this._oItemMap.keys()};i.prototype.containsItem=function(e){this._oItemMap.containsKey(e)};i.prototype.getItemValue=function(e){return this._oItemMap.get(e)};i.prototype.setItemValue=function(e,t){this._oItemMap.put(e,t);if(this._oBackendContainer){this._oBackendContainer.setItemValue(e,t)}};i.prototype.delItem=function(e){this._oItemMap.remove(e);if(this._oBackendContainer){this._oBackendContainer.delItem(e)}};return i});