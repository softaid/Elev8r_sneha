// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/resources","sap/ui/core/IconPool","sap/ui/core/routing/HashChanger","sap/ui/thirdparty/jquery","sap/ushell/renderers/fiori2/search/util"],function(e,a,r,n,s){"use strict";var i=false;var t=function(e){if(!e._searchShellHelperPromise){e._searchShellHelperPromise=new Promise(function(e){sap.ui.getCore().loadLibrary("sap.esh.search.ui",{async:true}).then(function(){sap.ui.require(["sap/esh/search/ui/SearchShellHelperAndModuleLoader","sap/esh/search/ui/SearchShellHelper"],function(a,r){r.init();e(r)})})})}return e._searchShellHelperPromise};function h(h){i=true;var l={id:"sf",tooltip:"{i18n>openSearchBtn}",text:"{i18n>searchBtn}",ariaLabel:"{i18n>openSearchBtn}",icon:a.getIconURI("search"),visible:true,showSeparator:false,press:function(e){t(h).then(function(a){a.onShellSearchButtonPressed(e)})}};var o=sap.ushell.Container.getRenderer("fiori2").addHeaderEndItem("sap.ushell.ui.shell.ShellHeadItem",l,true,false);if(s.isSearchFieldExpandedByDefault()){o.setVisible(false)}o.setModel(e.i18nModel,"i18n");if(s.isSearchFieldExpandedByDefault()){t(h).then(function(e){if(e.expandSearch){e.expandSearch()}else{o.setVisible(true)}})}h.oHashChanger=r.getInstance();h.oHashChanger.attachEvent("shellHashChanged",function(e){var a=e.mParameters;setTimeout(function(){sap.ui.getCore().loadLibrary("sap.esh.search.ui",{async:true}).then(function(){sap.ui.require(["sap/esh/search/ui/HashChangeHandler"],function(e){e.handle(a)})})},6e3)});o.addEventDelegate({onAfterRendering:function(){n("#sf").attr("aria-pressed",false)}})}function l(){if(i){sap.ushell.Container.getRenderer("fiori2").hideHeaderEndItem("sf");var e=sap.ui.getCore().byId("sf");if(e){e.destroy()}}}return{createContent:h,exit:l}});