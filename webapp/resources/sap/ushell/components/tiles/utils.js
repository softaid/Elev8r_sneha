// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/_ClientSideTargetResolution/PrelaunchOperations","sap/ushell/resources","sap/ui/thirdparty/datajs","sap/ui/core/mvc/View","sap/ui/model/json/JSONModel","sap/ui/core/library","sap/m/library","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/IconPool","sap/ui/core/Icon","sap/m/SelectDialog","sap/m/StandardListItem","sap/m/Text","sap/ui/core/CustomData","sap/ui/core/Item","sap/m/Label","sap/ui/model/Sorter","sap/ui/thirdparty/jquery","sap/base/Log","sap/ui/core/format/NumberFormat"],function(e,t,a,i,n,r,s,l,o,u,p,c,g,d,_,f,b,y,I,v,m){"use strict";var V=r.MessageType;var h=r.ValueState;var w=r.mvc.ViewType;var S=s.ButtonType;var x={};x.isInitial=function(e){return e==="App Launcher – Static"||e==="App Launcher – Dynamic"||e==="Target Mapping"};x.getResourceBundleModel=function(){return t.i18nModel};x.getEmptyRowObj=function(e){return{name:"",mandatory:false,value:"",isRegularExpression:false,defaultValue:"",valEnabled:false||!e,defValEnabled:true,editable:e}};x.getEmptyTileActionsRowObj=function(e){var t=x.getResourceBundleModel().getResourceBundle();return{menu_title:"",target_type:t.getText("configuration.tile_actions.table.target_type.url"),navigation_target:"",action:"",icon:"",isTargetTypeIntent:false,editable:e}};x.getTileNavigationActionsRows=function(e,t){var a=[],i=[];i=this.getTileNavigationActions(e);if(i.length){for(var n=0;n<i.length;n++){a.push(T(i[n],t))}}else{a=[this.getEmptyTileActionsRowObj(t)]}return a};x.getTileNavigationActions=function(e){var t=[],a="";var i=e.bag.getBag("tileNavigationActions");if(i.getPropertyNames().indexOf("tile_navigation_actions")>=0){t=JSON.parse(i.getProperty("tile_navigation_actions"));for(var n=0;n<t.length;n++){if(t[n].text){if(i.getTextNames().indexOf("action_tile_"+(n+1))>=0){a=i.getText("action_tile_"+(n+1))}t[n].text=a}}}return t};var T=function(e,t){var a={},i=x.getResourceBundleModel().getResourceBundle();a.menu_title=e.text;a.icon=e.icon;if(e.targetURL.charAt(0)==="#"){a.target_type=i.getText("configuration.tile_actions.table.target_type.intent");var n=e.targetURL.split("-");a.navigation_target=n[0].substring(1,n[0].length);a.action=n[1];a.isTargetTypeIntent=true}else{a.target_type=i.getText("configuration.tile_actions.table.target_type.url");a.navigation_target=e.targetURL;a.action="";a.isTargetTypeIntent=false}a.editable=t;return a};x.tileActionsRows2TileActionsArray=function(e){var t=[];for(var a=0;a<e.length;a++){if(e[a].menu_title){t.push(P(e[a]))}}return t};var P=function(e){var t={};t.text=e.menu_title;t.icon=e.icon;if(e.action){t.targetURL="#"+e.navigation_target+"-"+e.action}else{t.targetURL=e.navigation_target}return t};x.populateTileNavigationActionsBag=function(e,t){e.setProperty("tile_navigation_actions",JSON.stringify(t));for(var a=0;a<t.length;a++){var i=t[a].text;e.setText("action_tile_"+(a+1),i)}};x.getDefaultFormFactors=function(){return{appDefault:false,manual:{desktop:true,tablet:true,phone:true},defaultParam:true}};x.buildFormFactorsObject=function(e){return{appDefault:e.getProperty("/config/appFormFactor"),manual:{desktop:e.getProperty("/config/desktopChecked"),tablet:e.getProperty("/config/tabletChecked"),phone:e.getProperty("/config/phoneChecked")}}};x.tableHasDuplicateParameterNames=function(e){var t={};for(var a=0;a<e.length;a++){var i=e[a].name;if(i!==""){if(t[i]){return true}t[i]=true}}return false};x.tableHasInvalidSapPrelaunchOperationValue=function(t){for(var a=0;a<t.length;a++){if(t[a].name==="sap-prelaunch-operations"){if(e.parseAndValidateOperations(t[a].defaultValue)===null){return false}break}}return true};x.getMappingSignatureString=function(e,t){var a="";for(var i=0;i<e.length;i++){if(e[i].name){a+=D(e[i])+"&"}}return t?a+"*=*":a.substring(0,a.length-1)};var D=function(e){var t="";if(e.mandatory){if(e.isRegularExpression){t="{"+e.name+"="+encodeURIComponent(e.value)+"}"}else{t=e.name+"="+encodeURIComponent(e.value)}}else{t="["+e.name+"="+encodeURIComponent(e.defaultValue)+"]"}return t};x.getMappingSignatureTableData=function(e,t){var a=[];var i=e.split("&");for(var n=0;n<i.length;n++){var r=i[n];if(r!=="*=*"){a.push(C(i[n],t))}}return a};var C=function(e,t){var a={};if(e.charAt(0)==="["){a.mandatory=false;a.isRegularExpression=false;a.value="";e=e.substring(1,e.length-1);a.name=e.substring(0,e.indexOf("="));a.defaultValue=decodeURIComponent(e.substring(e.indexOf("=")+1))}else{a.mandatory=true;a.defaultValue="";if(e.charAt(0)==="{"){a.isRegularExpression=true;e=e.substring(1,e.length-1)}else{a.isRegularExpression=false}a.name=e.substring(0,e.indexOf("="));a.value=decodeURIComponent(e.substring(e.indexOf("=")+1))}a.editable=t;if(t){a.valEnabled=a.mandatory;a.defValEnabled=!a.mandatory}else{a.valEnabled=true;a.defValEnabled=true}return a};x.getAllowUnknownParametersValue=function(e){if(e&&e.substring(e.length-3,e.length)==="*=*"){return true}return false};x.getMappingSignature=function(e,t){var a=t?"allowed":"ignored";var i=new RegExp("%%UserDefault[.].+%%");var n=[];var r={parameters:{},additional_parameters:a};e.forEach(function(e){r.parameters[e.name]={required:e.mandatory,rename_to:e.rename_to};if(e.defaultValue){n=i.exec(e.defaultValue);if(n){e.defaultValue=n[0]}r.parameters[e.name].defaultValue={value:e.defaultValue}}if(e.value){n=i.exec(e.value);if(n){e.value=n[0]}r.parameters[e.name].filter={value:e.value};if(e.isRegularExpression){r.parameters[e.name].filter.format="regexp"}}});return r};x.getSignatureTableData=function(e,t){var a=[];var i={};var n={};var r=e.parameters;for(var s in r){n=r[s];i={};i.editable=t;i.name=s;i.mandatory=n.required;if(n.rename_to){i.rename_to=n.rename_to}else{i.rename_to=n.renameTo}if(t){i.valEnabled=i.mandatory;i.defValEnabled=!i.mandatory}else{i.valEnabled=true;i.defValEnabled=true}if(n.filter){i.value=n.filter.value;if(n.filter.format&&n.filter.format==="regexp"){i.isRegularExpression=true}}if(n.defaultValue){i.defaultValue=n.defaultValue.value}a.push(i)}return a};x.getTranslatedTitle=function(e){if(e.bag){var t=e.bag.getBag("tileProperties");if(t.getTextNames().indexOf("display_title_text")>=0){return t.getText("display_title_text")}}if(e.title){return e.title.getTitle()}if(e.preview){return e.preview.getTitle()}return""};x.getTranslatedSubtitle=function(e,t){if(e.bag){var a=e.bag.getBag("tileProperties");if(a.getTextNames().indexOf("display_subtitle_text")>=0){return a.getText("display_subtitle_text")}}if(typeof t.display_subtitle_text==="string"){return t.display_subtitle_text}if(e.preview&&e.preview.getDescription&&e.preview.getDescription()){return e.preview.getDescription()}return""};x.getTranslatedProperty=function(e,t,a){if(e.bag){var i=e.bag.getBag("tileProperties");if(i.getTextNames().indexOf(a)>=0){return i.getText(a)}}return t[a]};x.getActionConfiguration=function(e,t){var a=e.configuration.getParameterValueAsString("tileConfiguration");var i=JSON.parse(a||"{}"),n;if(typeof t==="undefined"){t=e.configurationUi.isEnabled()}if(t){n=x.getResourceBundleModel().getResourceBundle()}i.semantic_object=i.semantic_object||(t?"["+n.getText("configuration.semantic_object")+"]":"");i.semantic_action=i.semantic_action||(t?"["+n.getText("configuration.semantic_action")+"]":"");i.navigation_provider=i.navigation_provider||"";i.navigation_provider_role=i.navigation_provider_role||"";i.navigation_provider_instance=i.navigation_provider_instance||"";i.target_application_id=i.target_application_id||"";i.target_application_alias=i.target_application_alias||"";i.display_info_text=i.display_info_text||"";i.editable=true;if(e.configurationUi&&e.configurationUi.isReadOnly){if(e.configurationUi.isReadOnly()){i.editable=false}}return i};x.getViewConfiguration=function(e){var t=e.getViewData();var a=t.chip;var i=x.getAppLauncherConfig(a,true,true);return i};x.getConfigurationUi=function(e,t){var a,r,s,l,o;var u=e.getViewData();var p=x.getViewConfiguration(e);var c=new n({config:p,tileModel:e.getModel()});return i.create({type:w.XML,viewData:u,viewName:t}).then(function(t){t.setModel(c);a=t.byId("navigation_semantic_objectInput")||t.byId("semantic_objectInput");if(a){a.getModel().setProperty("/enabled",p.navigation_use_semantic_object);a.getModel().setProperty("/value",p.semantic_object||p.navigation_semantic_object)}r=t.byId("navigation_provider_roleInput");if(r){r.getModel().setProperty("/value",p.navigation_provider_role)}s=t.byId("navigation_provider_instanceInput");if(s){s.getModel().setProperty("/value",p.navigation_provider_instance)}l=t.byId("target_application_aliasInput");if(l){l.getModel().setProperty("/value",p.target_application_alias)}o=t.byId("targetTypeInput");if(o){if(!t.getModel().getProperty("/config/transaction")){t.getModel().setProperty("/config/transaction",{})}if(!t.getModel().getProperty("/config/web_dynpro")){t.getModel().setProperty("/config/web_dynpro",{})}if(e.getModel().getProperty("/config/navigation_provider")==="LPD"){x.displayLpdCustApplicationTypeFields(t)}else if(e.getModel().getProperty("/config/navigation_provider")==="WCF"){o.setSelectedKey("WCF");x.displayWCFApplicationTypeFields(t)}else if(e.getModel().getProperty("/config/navigation_provider")==="SAPUI5"||e.getModel().getProperty("/config/navigation_provider")===""){o.setSelectedKey("SAPUI5");x.displaySapui5ApplicationTypeFields(t)}else if(e.getModel().getProperty("/config/navigation_provider")==="TR"){x.displayTransactionApplicationTypeFields(t)}else if(e.getModel().getProperty("/config/navigation_provider")==="WDA"){x.displayWebDynproApplicationTypeFields(t)}else if(e.getModel().getProperty("/config/navigation_provider")==="URL"){x.displayURLApplicationTypeFields(t)}else if(e.getModel().getProperty("/config/navigation_provider")==="URLT"){x.displayURLTApplicationTypeFields(t);c.setProperty("/config/editable",false);c.setProperty("/config/manualFormFactor",false)}}return t})};x._updateTilePropertiesTexts=function(e,t){var a=t.getTextNames(),i=e.getModel();a.forEach(function(e){i.setProperty("/data/"+e,t.getText(e));i.setProperty("/config/"+e,t.getText(e))})};x._updateTileConfiguration=function(e,t){var a=e.getModel(),i=JSON.parse(t),n;Object.keys(i).forEach(function(e){n=i[e];a.setProperty("/data/"+e,n);a.setProperty("/config/"+e,n);if(e==="navigation_target_url"){a.setProperty("/nav/"+e,n)}})};x.aData=[];x.aActionData=[];x.aRoleData=[];x.aAliasData=[];x.objectSelectDoSearch=function(e){var t=[],a=e.getParameter("value"),i,n,r;if(a!==undefined){i=e.getParameter("itemsBinding");n=new l("name",o.Contains,a);r=new l("obj",o.Contains,a);t.push(r);t.push(n);i.filter(new l(t,false))}};x.actionSelectDoSearch=function(e){var t=[],a=e.getParameter("value"),i,n;if(a!==undefined){i=e.getParameter("itemsBinding");n=new l("text",o.Contains,a);t.push(n);i.filter(new l(t,false))}};x.roleSelectDoSearch=function(e){var t=[],a=e.getParameter("value"),i,n,r;if(a!==undefined){i=e.getParameter("itemsBinding");n=new l("role",o.Contains,a);r=new l("instance",o.Contains,a);t.push(n);t.push(r);i.filter(new l(t,false))}};x.instanceSelectDoSearch=function(e){var t=[],a=e.getParameter("value"),i,n,r,s,u;i=e.getSource().getCustomData();n=i[0].getValue();if(a!==undefined){r=e.getParameter("itemsBinding");if(a!==""){u=new l("instance",o.Contains,a);t.push(u)}if(n!==""){s=new l("role",o.EQ,n);t.push(s)}if(t.length>0){r.filter(new l(t,true))}}};x.instanceSuggest=function(e,t){var a=e.getView(),i=[],n=t.getParameter("value"),r,s,u,p,c;r=a.byId("navigation_provider_roleInput");s=r.getValue();n=t.getParameter("suggestValue");if(n!==""){c=new l("instance",o.Contains,n);i.push(c)}if(s!==""){p=new l("role",o.EQ,s);i.push(p)}if(i.length>0){u=t.oSource.getBinding("suggestionItems");u.filter(new l(i,true))}};x.aliasSuggest=function(e,t){var a=e.getView(),i=[],n=t.getParameter("value"),r,s,u,p,c;r=a.byId("navigation_provider_instanceInput");s=r.getValue();n=t.getParameter("suggestValue");if(n!==""){c=new l("alias",o.Contains,n);i.push(c)}if(s!==""){p=new l("instance",o.EQ,s);i.push(p)}if(i.length>0){u=t.oSource.getBinding("suggestionItems");u.filter(new l(i,true))}};x.aliasSelectDoSearch=function(e){var t=[],a=e.getParameter("value"),i,n,r,s,u;i=e.getSource().getCustomData();n=i[0].getValue();if(a!==undefined){r=e.getParameter("itemsBinding");s=new l("instance",o.EQ,n);if(a!==""){u=new l("alias",o.Contains,a);t.push(u)}t.push(s);r.filter(new l(t,true))}};x.objectSelectUpdateDialog=function(e,t){var a=[],i=e.getBinding("items"),n;if(t!==undefined){n=new l("name",o.Contains,t);a.push(n);i.filter(a)}};x.actionSelectUpdateDialog=function(e,t){var a=[],i=e.getBinding("items"),n;if(t!==undefined){n=new l("text",o.Contains,t);a.push(n);i.filter(a)}};x.roleSelectUpdateDialog=function(e,t){var a=[],i=e.getBinding("items"),n;if(t!==undefined){n=new l("role",o.Contains,t);a.push(n);i.filter(a)}};x.instanceSelectUpdateDialog=function(e,t){var a=[],i,n=e.getBinding("items"),r,s,u;i=e.getCustomData();s=i[0].getValue();if(t!==undefined){r=new l("instance",o.Contains,t);a.push(r)}if(s!==""){u=new l("role",o.EQ,s);a.push(u)}if(a.length>0){n.filter(a,true)}};x.aliasSelectUpdateDialog=function(e,t){var a=[],i,n,r=e.getBinding("items"),s,u;i=e.getCustomData();n=i[0].getValue();if(t!==undefined){u=new l("alias",o.Contains,t);a.push(u)}if(n!==""){s=new l("instance",o.EQ,n);a.push(s)}if(a.length>0){r.filter(a,true)}};x.sSelectedColor=(I(".sapMStdTileIconDiv").css("color")||"#007cc0").split(" ").join("");x.sDeselectedColor=(I(".sapMLabel:not(.sapFioriDropZoneText )").css("color")||"#666666").split(" ").join("");x.iconSelect=function(e,t){e.setColor(t?x.sSelectedColor:x.sDeselectedColor);e.setActiveColor(t?x.sDeselectedColor:x.sSelectedColor)};x.onSelectIcon=function(e,t,a,i){var n=e.getView().getModel(),r;if(t){r=n.getProperty("/config/tile_actions_selected_icon")}else{r=n.getProperty("/config/selected_icon")}if(r){x.iconSelect(r,false)}r=i.getSource();x.iconSelect(r,true);n.setProperty("/config/ok.enabled",true);if(t){n.setProperty("/config/tile_actions_selected_icon",r)}else{n.setProperty("/config/selected_icon",r)}e.byId("selectIconDialog").setTitle(r.getSrc())};x.onSelectIconClose=function(e){e.byId("selectIconDialog").close()};x.onSelectIconOk=function(e,t){var a=e.getModel().getProperty("/config/selected_icon");if(!t){e.getModel().setProperty("/config/display_icon_url",a.getSrc());e.byId("iconInput").setValueState(h.None)}else{a=e.getModel().getProperty("/config/tile_actions_selected_icon");if(a){t.setValue(a.getSrc());t.setValueState(h.None)}}x.onSelectIconClose(e)};x.iconSelectOnValueHelpRequest=function(e,t,a){var i=e.getView().getModel();var n=e.getView().byId("icons");var r=u.getIconCollectionNames();var s=e.getView().byId("selectIconDialog");var l=e.getView().byId("ok");var o,c,g,d,_,f,b,y=false;n.destroyContent();if(a){g=sap.ui.getCore().byId(t.getParameter("id"));c=g.getValue()}else{c=i.getProperty("/config/display_icon_url")}l.attachEventOnce("press",function(){x.onSelectIconOk(e.getView(),g)});r.sort();r=I.grep(r,function(e){if(e==="BusinessSuiteInAppSymbols"){y=true;return false}return true});if(y){r.push("BusinessSuiteInAppSymbols")}for(_=0;_<r.length;_+=1){d=u.getIconNames(r[_]);d.sort();for(f=0;f<d.length;f+=1){b=u.getIconURI(d[f],r[_]);n.addContent(new p({height:"38px",press:x.onSelectIcon.bind(null,e,a,g),size:"2rem",src:b,tooltip:b,width:"38px"}))}}o=n.getContent();i.setProperty("/config/ok.enabled",false);s.bindProperty("title",{model:"i18n",path:"configuration.select_icon"});for(_=0;_<o.length;_+=1){if(o[_].getSrc()===c){if(a){i.setProperty("/config/tile_actions_selected_icon",o[_])}else{i.setProperty("/config/selected_icon",o[_])}x.iconSelect(o[_],true);i.setProperty("/config/ok.enabled",true);s.setTitle(c)}else{x.iconSelect(o[_],false)}}s.open()};x.objectSelectOnValueHelpRequest=function(e,t,a){var i=e.getView();var r=x.getResourceBundleModel().getResourceBundle().getText("configuration.semantic_object");var s;var l;var o=new n;var u=new c("semantic_object_select_dialog",{title:r,search:x.objectSelectDoSearch,liveChange:x.objectSelectDoSearch}),p=new g({title:"{obj}"});if(a){s=sap.ui.getCore().byId(t.getParameter("id"))}else{s=i.byId("semantic_objectInput")||i.byId("navigation_semantic_objectInput")}l=s.getValue();u.open(l);o.setData(e.aDefaultObjects.concat(x.aData));u.bindAggregation("items","/",p);u.setModel(o);x.objectSelectUpdateDialog(u,l);u.attachCancel(function(e){s.setValue(l);if(!a){s.fireChange()}u.destroy();u=null});u.attachConfirm(function(e){var t=e.getParameter("selectedItem");if(t){s.setValue(t.getTitle());if(!a){s.fireChange()}}u.destroy();u=null})};x.actionSelectOnValueHelpRequest=function(e,t,a){var i=e.getView();var r=x.getResourceBundleModel().getResourceBundle().getText("configuration.semantic_action");var s;var l;var o=new n;var u=new c("semantic_action_select_dialog",{title:r,search:x.actionSelectDoSearch,liveChange:x.actionSelectDoSearch}),p=new g({title:"{text}"});if(a){s=sap.ui.getCore().byId(t.getParameter("id"))}else{s=i.byId("semantic_actionInput")||i.byId("navigation_semantic_actionInput")}l=s.getValue();u.open(l);o.setData(x.aActionData);u.bindAggregation("items","/items",p);u.setModel(o);x.actionSelectUpdateDialog(u,l);u.attachCancel(function(e){s.setValue(l);if(!a){s.fireChange()}u.destroy();u=null});u.attachConfirm(function(e){var t=e.getParameter("selectedItem");if(t){s.setValue(t.getTitle());if(!a){s.fireChange();s.fireLiveChange({newValue:t.getTitle()})}}u.destroy();u=null})};x.roleSelectOnValueHelpRequest=function(e){var t=e.getView(),a=x.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_role"),i,r,s,l=new n,o=new sap.m.TableSelectDialog("role_select_dialog",{title:a,search:x.roleSelectDoSearch,liveChange:x.roleSelectDoSearch,columns:[new sap.m.Column({header:[new d({text:x.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_role")})]}),new sap.m.Column({header:[new d({text:x.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_instance")})]})]}),u=new sap.m.ColumnListItem({cells:[new d({text:"{role}"}),new d({text:"{instance}"})]});i=t.byId("navigation_provider_roleInput");r=t.byId("navigation_provider_instanceInput");s=i.getValue();o.open(s);l.setData(e.aDefaultObjects.concat(x.aRoleData));o.bindAggregation("items","/",u);o.setModel(l);x.roleSelectUpdateDialog(o,s);o.attachCancel(function(e){i.setValue(s);i.fireChange();o.destroy();o=null});o.attachConfirm(function(e){var t=e.getParameter("selectedItem");if(t){i.setValue(t.getCells()[0].getText());r.setValue(t.getCells()[1].getText());i.fireChange();r.fireChange()}o.destroy();o=null})};x.instanceSelectOnValueHelpRequest=function(e){var t=e.getView();var a;var i=x.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_instance");var r;var s;var l=new n;var o=new c("instance_select_dialog",{title:i,search:x.instanceSelectDoSearch,liveChange:x.instanceSelectDoSearch}),u=new g({title:"{instance}"});r=t.byId("navigation_provider_instanceInput");s=r.getValue();a=t.byId("navigation_provider_roleInput").getValue();o.addCustomData(new _({key:"role",value:a}));o.open(s);l.setData(e.aDefaultObjects.concat(x.aRoleData));o.bindAggregation("items","/",u);o.setModel(l);x.instanceSelectUpdateDialog(o,s);o.attachCancel(function(e){r.setValue(s);r.fireChange();o.destroy();o=null});o.attachConfirm(function(e){var t=e.getParameter("selectedItem");if(t){r.setValue(t.getTitle());r.fireChange()}o.destroy();o=null})};x.applicationAliasSelectOnValueHelpRequest=function(e){var t=e.getView();var a=x.getResourceBundleModel().getResourceBundle().getText("configuration.target_application_alias");var i;var r;var s;var l=new n;var o=new c("alias_select_dialog",{title:a,search:x.aliasSelectDoSearch,liveChange:x.aliasSelectDoSearch}),u=new g({title:"{alias}"});i=t.byId("target_application_aliasInput");r=i.getValue();s=t.byId("navigation_provider_instanceInput").getValue();o.addCustomData(new _({key:"instance",value:s}));o.open(r);l.setData(e.aDefaultObjects.concat(x.aAliasData));o.bindAggregation("items","/",u);o.setModel(l);x.aliasSelectUpdateDialog(o,r);o.attachCancel(function(e){i.setValue(r);i.fireChange();o.destroy();o=null});o.attachConfirm(function(e){var t=e.getParameter("selectedItem");if(t){i.setValue(t.getTitle());i.fireChange()}o.destroy();o=null})};x.onTargetTypeChange=function(e){var t=e.getParameter("id");var a=sap.ui.getCore().byId(t).getParent().getCells();var i=e.getSource().getSelectedKey();if(i==="INT"){a[3].setEnabled(true);a[2].setShowValueHelp(true);a[2].setValue("")}else{a[2].setShowValueHelp(false);a[2].setValue("");a[3].setEnabled(false);a[3].setValue("")}};x.addTileActionsRow=function(e){var t=e.getModel();var a=t.getProperty("/config/tile_actions_rows");var i=this.getEmptyTileActionsRowObj();a.push(i);t.setProperty("/config/tile_actions_rows",a)};x.deleteTileActionsRow=function(e){var t=e.getModel();var a=t.getProperty("/config/tile_actions_rows");var i=e.byId("tileActions");var n=i.getSelectedIndices();var r=n.sort(function(e,t){return t-e}).slice();for(var s=0;s<r.length;s++){i.removeSelectionInterval(r[s],r[s]);a.splice(r[s],1)}t.setProperty("/config/tile_actions_rows",a)};x.checkInput=function(e,t){var a=x.getResourceBundleModel().getResourceBundle(),i=e.byId("iconInput"),n=e.byId("useLpdCheckbox"),r=e.byId("navigation_semantic_objectInput")||e.byId("semantic_objectInput"),s=e.byId("navigation_semantic_actionInput")||e.byId("semantic_actionInput"),l=h.None,o=null,u=I.trim(t.getParameter("newValue"));switch(t.getSource()){case i:if(u!==""&&u.substring(0,11)!=="sap-icon://"){l=h.Error;o=a.getText("configuration.display_icon_url.warning")}break;case n:if(!n.getSelected()){s.setValueState(h.None);r.setValueState(h.None)}break;case r:if(/[-#&? ]/.test(u)){l=h.Error;o=a.getText("configuration.semantic_object.error_invalid_chars")}else if(u===""){l=h.Error}break;case s:if(/[-#&? ]/.test(u)){l=h.Error;o=a.getText("configuration.semantic_action.error_invalid_chars")}else if(u===""){l=h.Error}break;default:break}if(l){t.getSource().setValueState(l);if(o!==null){t.getSource().setValueStateText(o||"")}}};x.checkInputOnSaveConfig=function(e){var t=e.byId("iconInput");var a=e.byId("navigation_semantic_objectInput");var i=e.byId("navigation_semantic_actionInput");var n=e.byId("useLpdCheckbox");var r=x.getResourceBundleModel().getResourceBundle();var s=false;if(t.getValue()!==""&&!x.isIconURIValid(t.getValue())){t.setValueState(h.Error);t.setValueStateText(r.getText("configuration.display_icon_url.warning"));s=true}if(n.getSelected()&&/[-#&? ]/.test(a.getValue())){a.setValueState(h.Error);a.setValueStateText(r.getText("configuration.semantic_object.error_invalid_chars"));s=true}else if(n.getSelected()&&a.getValue()===""){a.setValueState(h.Error);s=true}if(/[-#&? ]/.test(i.getValue())){i.setValueState(h.Error);i.setValueStateText(r.getText("configuration.semantic_action.error_invalid_chars"));s=true}else if(n.getSelected()&&i.getValue()===""){i.setValueState(h.Error);s=true}return s};x.checkTileActions=function(e){var t=e.getModel().getProperty("/config/tile_actions_rows");var a=x.getResourceBundleModel().getResourceBundle();var i=false;for(var n=0;n<t.length;n++){if(!t[n].menu_title&&(t[n].navigation_target||t.length>1)){t[n].valueState=h.Error;i=true}else{t[n].valueState=h.None}if(t[n].icon){if(!x.isIconURIValid(t[n].icon)){t[n].iconValueState=h.Error;t[n].iconValueStateText=a.getText("configuration.display_icon_url.warning");i=true}}}e.getModel().setProperty("/config/tile_actions_rows",t);return i};x.isIconURIValid=function(e){var t=[];var a="";var i="";var n="";t=/sap-icon:\/\/(.+)\//.exec(e);if(t){a=t[1];t=/\/\/.+\/(.+)/.exec(e);if(t){i=t[1]}else{i=""}n=u.getIconURI(i,a);if(n!==e){return false}}else{t=/sap-icon:\/\/(.+)/.exec(e);if(t){i=t[1];if(!u.getIconInfo(i)){return false}}else{return false}}return true};x.checkTMInput=function(e,t){var a=x.getResourceBundleModel().getResourceBundle(),i=e.byId("semantic_objectInput"),n=e.byId("semantic_actionInput"),r=e.byId("target_application_descriptionInput"),s=e.byId("target_application_urlInput"),l=e.byId("target_application_componentInput"),o=e.byId("navigation_provider_roleInput"),u=e.byId("navigation_provider_instanceInput"),p=e.byId("target_application_aliasInput"),c=e.byId("target_application_idInput"),g=I.trim(t.getParameter("newValue")),d=h.None,_=null;switch(t.getSource()){case i:if(/[-#&? ]/.test(g)){d=h.Error;_=a.getText("configuration.semantic_object.error_invalid_chars")}if(n.getValue()===""){n.setValueState(h.Error)}break;case n:if(/[-#&? ]/.test(g)){d=h.Error;_=a.getText("configuration.semantic_action.error_invalid_chars")}else if(g===""){d=h.Error}break;case r:if(g===""){d=h.Error}break;case s:if(g!==""&&!/^[-~+,;:?%&#=/.\w]+$/.test(g)){d=h.Error;_=a.getText("configuration.target_application.url.error_invalid_chars")}break;case l:if(g===""){d=h.Error}else if(g.substring(0,17)==="SAPUI5.Component="){d=h.Error;_=a.getText("configuration.target_application.component.error_invalid_input")}break;case o:if(g===""){d=h.Error}else if(!/^[\w/]+$/.test(g)){d=h.Error;_=a.getText("configuration.target_application.role.error_invalid_chars")}break;case u:if(g===""){d=h.Error}else if(!/^[\w/]+$/.test(g)){d=h.Error;_=a.getText("configuration.target_application.instance.error_invalid_chars")}break;case p:if(g===""&&c.getValue()===""){d=h.Error;_=a.getText("configuration.target_application.alias_id.warning")}else if(g!==""&&c.getValue()!==""){d=h.Error;_=a.getText("configuration.target_application.alias_id.warning");c.setValueState(d);c.setValueStateText(_)}else{c.setValueState(h.None)}break;case c:if(g===""&&p.getValue()===""){d=h.Error;_=a.getText("configuration.target_application.alias_id.warning")}else if(g!==""&&p.getValue()!==""){d=h.Error;_=a.getText("configuration.target_application.alias_id.warning");p.setValueState(d);p.setValueStateText(_)}else if(g!==""&&!/^[A-Fa-f0-9]+$/.test(g)){d=h.Error;_=a.getText("configuration.target_application.alias_id.error_invalid_chars")}else{p.setValueState(h.None)}break;default:break}if(d){t.getSource().setValueState(d);if(_!==null){t.getSource().setValueStateText(_||"")}}};x.checkTMInputOnSaveConfig=function(e){var t=x.getResourceBundleModel().getResourceBundle();var a=e.byId("semantic_objectInput");var i=e.byId("semantic_actionInput");var n=e.byId("target_application_descriptionInput");var r=e.byId("target_application_urlInput");var s=e.byId("target_application_componentInput");var l=e.byId("navigation_provider_roleInput");var o=e.byId("navigation_provider_instanceInput");var u=e.byId("target_application_aliasInput");var p=e.byId("target_application_idInput");var c=e.byId("targetTypeInput");var g=e.byId("target_transactionInput");var d=e.byId("target_web_dynpro_applicationInput");var _=e.byId("target_wcf_application_idInput");var f=e.byId("desktopCB");var b=e.byId("tabletCB");var y=e.byId("phoneCB");var I=false;a.setValue(a.getValue().trim());if(/[-#&? ]/.test(a.getValue())){a.setValueState(h.Error);a.setValueStateText(t.getText("configuration.semantic_object.error_invalid_chars"));I=true}i.setValue(i.getValue().trim());if(/[-#&? ]/.test(i.getValue())){i.setValueState(h.Error);i.setValueStateText(t.getText("configuration.semantic_action.error_invalid_chars"));I=true}else if(i.getValue()===""){i.setValueState(h.Error);I=true}var v=e.getModel().getProperty("/config/navigation_provider"),m;if(v==="SAPUI5"){if(n.getValue()===""){n.setValueState(h.Error);I=true}if(r.getValue()!==""&&!/^[-~+,;:?%&#=/.\w]+$/.test(r.getValue())){r.setValueState(h.Error);r.setValueStateText(t.getText("configuration.target_application.url.error_invalid_chars"));I=true}if(s.getValue()===""){s.setValueState(h.Error);I=true}else if(s.getValue().substring(0,17)==="SAPUI5.Component="){s.setValueState(h.Error);s.setValueStateText(t.getText("configuration.target_application.component.error_invalid_input"));I=true}}else if(v==="LPD"){if(l.getValue()===""){l.setValueState(h.Error);I=true}if(!/^[\w]+$/.test(l.getValue())){l.setValueState(h.Error);m=t.getText("configuration.target_application.role.error_invalid_chars");l.setValueStateText(m);I=true}if(o.getValue()===""){o.setValueState(h.Error);I=true}if(!/^[\w]+$/.test(o.getValue())){o.setValueState(h.Error);m=t.getText("configuration.target_application.instance.error_invalid_chars");o.setValueStateText(m);I=true}if(u.getValue()===""&&p.getValue()===""){m=t.getText("configuration.target_application.alias_id.warning");u.setValueState(h.Error);u.setValueStateText(m);p.setValueState(h.Error);p.setValueStateText(m);I=true}if(u.getValue()!==""&&p.getValue()!==""){m=t.getText("configuration.target_application.alias_id.warning");u.setValueState(h.Error);u.setValueStateText(m);p.setValueState(h.Error);p.setValueStateText(m);I=true}if(p.getValue()!==""&&!/^[A-Fa-f0-9]+$/.test(p.getValue())){p.setValueState(h.Error);p.setValueStateText(t.getText("configuration.target_application.alias_id.error_invalid_chars"));I=true}}else if(v==="TR"){if(g.getValue()===""){g.setValueState(h.Error);I=true}}else if(v==="WDA"){if(d.getValue()===""){d.setValueState(h.Error);I=true}}else if(v==="WCF"){if(_.getValue()===""){_.setValueState(h.Error);I=true}}else if(v==="URL"){if(r.getValue()===""){r.setValueState(h.Error);I=true}else if(!/^[-~+,;:?%&#=/.\w]+$/.test(r.getValue())){r.setValueState(h.Error);r.setValueStateText(t.getText("configuration.target_application.url.error_invalid_chars"));I=true}}else{c.setValueState(h.Error);c.setValueStateText(t.getText("configuration.navigation_provider.error_invalid_provider"));I=true}if(!f.getSelected()&&!b.getSelected()&&!y.getSelected()){m=t.getText("configuration.form_factor.warning");f.setValueState(h.Error);f.setValueStateText(m);b.setValueState(h.Error);b.setValueStateText(m);y.setValueState(h.Error);y.setValueStateText(m);I=true}return I};x.updateTooltipForDisabledProperties=function(e){var t=e.getModel();var a=t.getProperty("/config/isLocaleSuitable");if(!a){var i=x.getResourceBundleModel().getResourceBundle();var n=i.getText("edit_configuration.original_locale_not_fit_tooltip",[t.getProperty("/config/userLocale"),t.getProperty("/config/orgLocale")]);e.byId("titleInput").setTooltip(n);e.byId("subtitleInput").setTooltip(n);e.byId("keywordsInput").setTooltip(n);e.byId("infoInput").setTooltip(n)}};x.updateMessageStripForOriginalLanguage=function(e){var t=e.getModel();if(t.getProperty("/config/isLocaleSuitable")===false){var a=x.getResourceBundleModel().getResourceBundle().getText("edit_configuration.original_locale_not_fit_message",[t.getProperty("/config/orgLocale").toUpperCase(),t.getProperty("/config/userLocale").toUpperCase()]);var i=e.byId("messageStrip");i.setVisible(true);i.setText(a);i.setType(V.Warning)}};x.createSemanticObjectModel=function(e,t,i){var r=e.getView(),s="/sap/opu/odata/UI2/INTEROP/SemanticObjects",l=[{obj:"",name:""},{obj:"*",name:"*"}],o=(i||l).slice(0),u=new n;u.setSizeLimit(999999);u.setProperty("/value","");u.setProperty("/enabled",true);t.bindAggregation("suggestionItems","suggest>/items",new f({text:"{suggest>obj}"}));t.setModel(u,"suggest");if(x.aData.length>0){setTimeout(function(){u.setData({items:o.concat(x.aData)},true)},0);return}a.read({requestUri:s,headers:{Accept:"application/json"}},function(e){var t,a,i;for(i=0;i<e.results.length;i=i+1){t=e.results[i].id;a=e.results[i].text;x.aData.push({obj:t,name:a||t})}u.setData({items:o.concat(x.aData)},true)},function(e){var t=e&&e.message?e.message:e;if(e.response){t+=" - "+e.response.statusCode+" "+e.response.statusText}v.error("Could not fetch data: "+s+": "+t,null,r.getViewName()||"sap.ushell.components.tiles.utils")})};x.createRoleModel=function(e,t,i){var r=e.getView(),s="/sap/opu/odata/UI2/INTEROP/GetLPDInstances",l=new n,o=new n;l.setSizeLimit(999999);o.setSizeLimit(999999);l.setProperty("/value","");l.setProperty("/enabled",true);o.setProperty("/value","");o.setProperty("/enabled",true);var u=new sap.m.ColumnListItem({cells:[new b({text:"{role}"}),new b({text:"{instance}"})]});t.bindAggregation("suggestionRows","/items",u);i.bindAggregation("suggestionItems","/items",new f({text:"{instance}"}));i.setModel(o);t.setModel(l);t.attachSuggestionItemSelected(function(e){i.setValue(e.getParameter("selectedRow").getCells()[1].getText());i.fireChange()});if(x.aRoleData.length>0){l.setData({items:x.aRoleData},false);o.setData({items:x.aRoleData},false);return}a.read({requestUri:s,headers:{Accept:"application/json"}},function(e){var t,a,i;for(i=0;i<e.results.length;i=i+1){t=e.results[i].lpdRole;a=e.results[i].instance;x.aRoleData.push({role:t,instance:a})}l.setData({items:x.aRoleData},true);o.setData({items:x.aRoleData},true)},function(e){var t=e&&e.message?e.message:e;if(e.response){t+=" - "+e.response.statusCode+" "+e.response.statusText}v.error("Could not fetch data: "+s+": "+t,null,r.getViewName()||"sap.ushell.components.tiles.utils")})};x.createAliasModel=function(e,t){var i=e.getView(),r,s="/sap/opu/odata/UI2/INTEROP/GetLPDAppAlias",l=new n;l.setSizeLimit(999999);l.setProperty("/value","");l.setProperty("/enabled",true);t.bindAggregation("suggestionItems","/items",new f({text:"{alias}"}));t.setModel(l);r=x.getAppLauncherConfig(i.oViewData.chip,true,true);if(r&&r.navigation_provider_role&&r.navigation_provider_instance){if(r.navigation_provider_role!==""&&r.navigation_provider_instance!==""){s=s+"?role='"+r.navigation_provider_role+"'&instance='"+r.navigation_provider_instance+"'"}}a.read({requestUri:s,headers:{Accept:"application/json"}},function(e){var t,a,i,n,r;x.aAliasData=[];for(n=0;n<e.results.length;n=n+1){t=e.results[n].lpdApplicationAlias;a=e.results[n].lpdRole;i=e.results[n].lpdInstance;x.aAliasData.push({role:a,instance:i,alias:t})}r=l.getData();if(r){r.items=x.aAliasData}else{r={items:x.aAliasData}}l.setData(r,false)},function(e){var t=e&&e.message?e.message:e;if(e.response){t+=" - "+e.response.statusCode+" "+e.response.statusText}v.error("Could not fetch data: "+s+": "+t,null,i.getViewName()||"sap.ushell.components.tiles.utils")})};x.updateAliasModel=function(e,t){var i,n,r,s=t.getModel();n=e.byId("navigation_provider_instanceInput").getValue();r=e.byId("navigation_provider_roleInput").getValue();i="/sap/opu/odata/UI2/INTEROP/GetLPDAppAlias?role='"+r+"'&instance='"+n+"'";a.read({requestUri:i,headers:{Accept:"application/json"}},function(e){var t,a,i,n,r;x.aAliasData=[];for(n=0;n<e.results.length;n=n+1){t=e.results[n].lpdApplicationAlias;a=e.results[n].lpdRole;i=e.results[n].lpdInstance;x.aAliasData.push({role:a,instance:i,alias:t})}r=s.getData();if(r){r.items=x.aAliasData}else{r={items:x.aAliasData}}s.setData(r,false)},function(t){var a=t&&t.message?t.message:t;if(t.response){a+=" - "+t.response.statusCode+" "+t.response.statusText}v.error("Could not fetch data: "+i+": "+a,null,e.getViewName()||"sap.ushell.components.tiles.utils")})};x.createActionModel=function(e,t){var a=new n;var i=e.getView(),r,s;a.setData({items:[{text:"display"},{text:"approve"},{text:"displayFactSheet"},{text:"manage"},{text:"create"},{text:"monitor"},{text:"track"},{text:"change"},{text:"register"},{text:"release"},{text:"analyzeKPIDetails"},{text:"lookup"},{text:"manageLineItems"}]});x.aActionData=a.getData();r=x.getAppLauncherConfig(i.oViewData.chip,true,true);s=r.navigation_semantic_action||r.semantic_action;if(s){if(!a.getData().items.some(function(e){return e.text===s})){a.getData().items.push({text:s})}}t.bindAggregation("suggestionItems","items>/items",new f({text:"{items>text}"}));t.setModel(a,"items");t.getBinding("suggestionItems").sort(new y("text",false))};x.createNavigationProviderModel=function(e,t){var a=new n;var i=x.getResourceBundleModel().getResourceBundle();var r=[{key:"SAPUI5",text:i.getText("configuration.target_application.sapui5")},{key:"LPD",text:i.getText("configuration.target_application.lpd_cust")},{key:"TR",text:i.getText("configuration.target_application.transaction")},{key:"WDA",text:i.getText("configuration.target_application.web_dynpro")},{key:"URL",text:i.getText("configuration.target_application.url")}];var s=x.getViewConfiguration(e.getView()).navigation_provider;if(s==="WCF"){r.push({key:"WCF",text:i.getText("configuration.target_application.wcf")})}else if(s==="URLT"){r.push({key:"URLT",text:i.getText("configuration.target_application.urlt")})}a.setData({items:r});t.bindItems("items>/items",new f({key:"{items>key}",text:"{items>text}"}));t.setModel(a,"items");t.getBinding("items").sort(new y("text",false))};x.displayApplicationTypeFields=function(e,t){switch(e){case"LPD":x.displayLpdCustApplicationTypeFields(t);break;case"SAPUI5":x.displaySapui5ApplicationTypeFields(t);break;case"TR":x.displayTransactionApplicationTypeFields(t);break;case"WDA":x.displayWebDynproApplicationTypeFields(t);break;case"URL":x.displayURLApplicationTypeFields(t);break;case"WCF":x.displayWCFApplicationTypeFields(t);break;case"URLT":x.displayURLTApplicationTypeFields(t);break}};x.displayWCFApplicationTypeFields=function(e){e.byId("navigation_provider_role").setVisible(false);e.byId("navigation_provider_roleInput").setVisible(false);e.byId("navigation_provider_instance").setVisible(false);e.byId("navigation_provider_instanceInput").setVisible(false);e.byId("target_application_alias").setVisible(false);e.byId("target_application_aliasInput").setVisible(false);e.byId("target_application_id").setVisible(false);e.byId("target_application_idInput").setVisible(false);e.byId("application_description").setVisible(true);e.byId("target_application_descriptionInput").setVisible(true);e.byId("application_url").setVisible(false);e.byId("target_application_urlInput").setVisible(false);e.byId("application_component").setVisible(false);e.byId("target_application_componentInput").setVisible(false);e.byId("target_transaction").setVisible(false);e.byId("target_transactionInput").setVisible(false);e.byId("target_wcf_application_id").setVisible(true);e.byId("target_wcf_application_idInput").setVisible(true);e.byId("target_web_dynpro_application").setVisible(false);e.byId("target_web_dynpro_applicationInput").setVisible(false);e.byId("target_web_dynpro_configuration").setVisible(false);e.byId("target_web_dynpro_configurationInput").setVisible(false);e.byId("target_system_alias").setVisible(true);e.byId("target_system_aliasInput").setVisible(true);e.byId("urlt_application_component").setVisible(false);e.byId("urlt_application_componentInput").setVisible(false);e.byId("target_urlt_system_alias").setVisible(false);e.byId("target_urlt_system_aliasInput").setVisible(false);e.byId("application_type_deprecated").setVisible(false)};x.displaySapui5ApplicationTypeFields=function(e){e.byId("navigation_provider_role").setVisible(false);e.byId("navigation_provider_roleInput").setVisible(false);e.byId("navigation_provider_instance").setVisible(false);e.byId("navigation_provider_instanceInput").setVisible(false);e.byId("target_application_alias").setVisible(false);e.byId("target_application_aliasInput").setVisible(false);e.byId("target_application_id").setVisible(false);e.byId("target_application_idInput").setVisible(false);e.byId("application_description").setVisible(true);e.byId("target_application_descriptionInput").setVisible(true);e.byId("application_url").setVisible(true);e.byId("target_application_urlInput").setVisible(true);e.byId("application_component").setVisible(true);e.byId("target_application_componentInput").setVisible(true);e.byId("target_transaction").setVisible(false);e.byId("target_transactionInput").setVisible(false);e.byId("target_wcf_application_id").setVisible(false);e.byId("target_wcf_application_idInput").setVisible(false);e.byId("target_web_dynpro_application").setVisible(false);e.byId("target_web_dynpro_applicationInput").setVisible(false);e.byId("target_web_dynpro_configuration").setVisible(false);e.byId("target_web_dynpro_configurationInput").setVisible(false);e.byId("target_system_alias").setVisible(false);e.byId("target_system_aliasInput").setVisible(false);e.byId("urlt_application_component").setVisible(false);e.byId("urlt_application_componentInput").setVisible(false);e.byId("target_urlt_system_alias").setVisible(false);e.byId("target_urlt_system_aliasInput").setVisible(false);e.byId("application_type_deprecated").setVisible(false)};x.displayLpdCustApplicationTypeFields=function(e){e.byId("application_description").setVisible(false);e.byId("target_application_descriptionInput").setVisible(false);e.byId("application_url").setVisible(false);e.byId("target_application_urlInput").setVisible(false);e.byId("application_component").setVisible(false);e.byId("target_application_componentInput").setVisible(false);e.byId("navigation_provider_role").setVisible(true);e.byId("navigation_provider_roleInput").setVisible(true);e.byId("navigation_provider_instance").setVisible(true);e.byId("navigation_provider_instanceInput").setVisible(true);e.byId("target_application_alias").setVisible(true);e.byId("target_application_aliasInput").setVisible(true);e.byId("target_application_id").setVisible(true);e.byId("target_application_idInput").setVisible(true);e.byId("target_transaction").setVisible(false);e.byId("target_transactionInput").setVisible(false);e.byId("target_wcf_application_id").setVisible(false);e.byId("target_wcf_application_idInput").setVisible(false);e.byId("target_web_dynpro_application").setVisible(false);e.byId("target_web_dynpro_applicationInput").setVisible(false);e.byId("target_web_dynpro_configuration").setVisible(false);e.byId("target_web_dynpro_configurationInput").setVisible(false);e.byId("target_system_alias").setVisible(false);e.byId("target_system_aliasInput").setVisible(false);e.byId("urlt_application_component").setVisible(false);e.byId("urlt_application_componentInput").setVisible(false);e.byId("target_urlt_system_alias").setVisible(false);e.byId("target_urlt_system_aliasInput").setVisible(false);e.byId("application_type_deprecated").setVisible(true)};x.displayTransactionApplicationTypeFields=function(e){e.byId("application_description").setVisible(true);e.byId("target_application_descriptionInput").setVisible(true);e.byId("application_url").setVisible(false);e.byId("target_application_urlInput").setVisible(false);e.byId("application_component").setVisible(false);e.byId("target_application_componentInput").setVisible(false);e.byId("navigation_provider_role").setVisible(false);e.byId("navigation_provider_roleInput").setVisible(false);e.byId("navigation_provider_instance").setVisible(false);e.byId("navigation_provider_instanceInput").setVisible(false);e.byId("target_application_alias").setVisible(false);e.byId("target_application_aliasInput").setVisible(false);e.byId("target_application_id").setVisible(false);e.byId("target_application_idInput").setVisible(false);e.byId("target_transaction").setVisible(true);e.byId("target_transactionInput").setVisible(true);e.byId("target_wcf_application_id").setVisible(false);e.byId("target_wcf_application_idInput").setVisible(false);e.byId("target_web_dynpro_application").setVisible(false);e.byId("target_web_dynpro_applicationInput").setVisible(false);e.byId("target_web_dynpro_configuration").setVisible(false);e.byId("target_web_dynpro_configurationInput").setVisible(false);e.byId("target_system_alias").setVisible(true);e.byId("target_system_aliasInput").setVisible(true);e.byId("urlt_application_component").setVisible(false);e.byId("urlt_application_componentInput").setVisible(false);e.byId("target_urlt_system_alias").setVisible(false);e.byId("target_urlt_system_aliasInput").setVisible(false);e.byId("application_type_deprecated").setVisible(false)};x.displayWebDynproApplicationTypeFields=function(e){e.byId("application_description").setVisible(true);e.byId("target_application_descriptionInput").setVisible(true);e.byId("application_url").setVisible(false);e.byId("target_application_urlInput").setVisible(false);e.byId("application_component").setVisible(false);e.byId("target_application_componentInput").setVisible(false);e.byId("navigation_provider_role").setVisible(false);e.byId("navigation_provider_roleInput").setVisible(false);e.byId("navigation_provider_instance").setVisible(false);e.byId("navigation_provider_instanceInput").setVisible(false);e.byId("target_application_alias").setVisible(false);e.byId("target_application_aliasInput").setVisible(false);e.byId("target_application_id").setVisible(false);e.byId("target_application_idInput").setVisible(false);e.byId("target_transaction").setVisible(false);e.byId("target_transactionInput").setVisible(false);e.byId("target_wcf_application_id").setVisible(false);e.byId("target_wcf_application_idInput").setVisible(false);e.byId("target_web_dynpro_application").setVisible(true);e.byId("target_web_dynpro_applicationInput").setVisible(true);e.byId("target_web_dynpro_configuration").setVisible(true);e.byId("target_web_dynpro_configurationInput").setVisible(true);e.byId("target_system_alias").setVisible(true);e.byId("target_system_aliasInput").setVisible(true);e.byId("urlt_application_component").setVisible(false);e.byId("urlt_application_componentInput").setVisible(false);e.byId("target_urlt_system_alias").setVisible(false);e.byId("target_urlt_system_aliasInput").setVisible(false);e.byId("application_type_deprecated").setVisible(false)};x.displayURLApplicationTypeFields=function(e){e.byId("navigation_provider_role").setVisible(false);e.byId("navigation_provider_roleInput").setVisible(false);e.byId("navigation_provider_instance").setVisible(false);e.byId("navigation_provider_instanceInput").setVisible(false);e.byId("target_application_alias").setVisible(false);e.byId("target_application_aliasInput").setVisible(false);e.byId("target_application_id").setVisible(false);e.byId("target_application_idInput").setVisible(false);e.byId("application_description").setVisible(true);e.byId("target_application_descriptionInput").setVisible(true);e.byId("application_url").setVisible(true);e.byId("target_application_urlInput").setVisible(true);e.byId("application_component").setVisible(false);e.byId("target_application_componentInput").setVisible(false);e.byId("target_transaction").setVisible(false);e.byId("target_transactionInput").setVisible(false);e.byId("target_wcf_application_id").setVisible(false);e.byId("target_wcf_application_idInput").setVisible(false);e.byId("target_web_dynpro_application").setVisible(false);e.byId("target_web_dynpro_applicationInput").setVisible(false);e.byId("target_web_dynpro_configuration").setVisible(false);e.byId("target_web_dynpro_configurationInput").setVisible(false);e.byId("target_system_alias").setVisible(true);e.byId("target_system_aliasInput").setVisible(true);e.byId("urlt_application_component").setVisible(false);e.byId("urlt_application_componentInput").setVisible(false);e.byId("target_urlt_system_alias").setVisible(false);e.byId("target_urlt_system_aliasInput").setVisible(false);e.byId("application_type_deprecated").setVisible(false)};x.displayURLTApplicationTypeFields=function(e){e.byId("navigation_provider_role").setVisible(false);e.byId("navigation_provider_roleInput").setVisible(false);e.byId("navigation_provider_instance").setVisible(false);e.byId("navigation_provider_instanceInput").setVisible(false);e.byId("target_application_alias").setVisible(false);e.byId("target_application_aliasInput").setVisible(false);e.byId("target_application_id").setVisible(false);e.byId("target_application_idInput").setVisible(false);e.byId("application_description").setVisible(true);e.byId("target_application_descriptionInput").setVisible(true);e.byId("application_url").setVisible(false);e.byId("target_application_urlInput").setVisible(false);e.byId("application_component").setVisible(false);e.byId("target_application_componentInput").setVisible(false);e.byId("target_transaction").setVisible(false);e.byId("target_transactionInput").setVisible(false);e.byId("target_wcf_application_id").setVisible(false);e.byId("target_wcf_application_idInput").setVisible(false);e.byId("target_web_dynpro_application").setVisible(false);e.byId("target_web_dynpro_applicationInput").setVisible(false);e.byId("target_web_dynpro_configuration").setVisible(false);e.byId("target_web_dynpro_configurationInput").setVisible(false);e.byId("target_system_alias").setVisible(false);e.byId("target_system_aliasInput").setVisible(false);e.byId("urlt_application_component").setVisible(true);e.byId("urlt_application_componentInput").setVisible(true);e.byId("target_urlt_system_alias").setVisible(true);e.byId("target_urlt_system_aliasInput").setVisible(true);e.byId("application_type_deprecated").setVisible(false)};x.getAppLauncherConfig=function(e,t,a){var i;var n=e.configuration.getParameterValueAsString("tileConfiguration");var r;try{r=JSON.parse(n||"{}")}catch(e){v.error("Error while trying to parse tile configuration",e,"sap.ushell.components.tiles.utils");return{}}r.editable=true;if(e.configurationUi&&e.configurationUi.isReadOnly){if(e.configurationUi.isReadOnly()){r.editable=false}}var s=x.getTranslatedTitle(e);var l=x.getTranslatedSubtitle(e,r);var o=x.getTranslatedProperty(e,r,"display_info_text");var u=x.getTranslatedProperty(e,r,"display_search_keywords");if(t){i=x.getResourceBundleModel().getResourceBundle();if(a&&e.bag){var p=e.bag.getOriginalLanguage();var c=sap.ui.getCore().getConfiguration().getLocale().getSAPLogonLanguage();var g=sap.ui.getCore().getConfiguration().getLanguage();r.isLocaleSuitable=p===""||p.toLowerCase()===c.toLowerCase()||p.toLowerCase()===g.toLowerCase();r.orgLocale=p;r.userLocale=c}}r.display_icon_url=r.display_icon_url||"";if(o!==undefined){r.display_info_text=o}else if(r.display_info_text===undefined){if(t&&!a){r.display_info_text="["+i.getText("configuration.display_info_text")+"]"}else{r.display_info_text=""}}r.navigation_semantic_object=r.navigation_semantic_object||"";r.navigation_semantic_action=r.navigation_semantic_action||"";r.navigation_semantic_parameters=r.navigation_semantic_parameters||"";r.display_number_unit=r.display_number_unit||"";r.display_number_factor=r.display_number_factor||"";r.service_refresh_interval=r.service_refresh_interval?parseInt(r.service_refresh_interval,10):0;r.service_url=r.service_url||"";r.navigation_target_url=r.navigation_target_url||"";if(t&&x.isInitial(s)){r.display_title_text=a?"":"["+i.getText("configuration.display_title_text")+"]";r.display_subtitle_text=a?"":"["+i.getText("configuration.display_subtitle_text")+"]"}else{r.display_title_text=s||r.display_title_text||"";if(l!==undefined){r.display_subtitle_text=l}else if(r.display_subtitle_text===undefined){r.display_subtitle_text=""}}r.navigation_use_semantic_object=r.navigation_use_semantic_object!==false;r.display_search_keywords=u||r.display_search_keywords||"";if(t){r.display_number_value=r.display_number_value||1234}r.form_factors=r.form_factors?r.form_factors:x.getDefaultFormFactors();r.desktopChecked=r.form_factors.manual.desktop;r.tabletChecked=r.form_factors.manual.tablet;r.phoneChecked=r.form_factors.manual.phone;r.manualFormFactor=!r.form_factors.appDefault&&r.editable;r.appFormFactor=r.form_factors.appDefault;r.formFactorConfigDefault=!!r.form_factors.defaultParam;if(r.signature){r.rows=x.getSignatureTableData(r.signature,a&&r.editable)}else{r.rows=r.mapping_signature&&r.mapping_signature!=="*=*"?x.getMappingSignatureTableData(r.mapping_signature,a&&r.editable):[x.getEmptyRowObj(r.editable)]}if(r.signature){r.isUnknownAllowed=r.signature.additional_parameters==="allowed"||r.signature.additionalParameters==="allowed"}else{r.isUnknownAllowed=r.mapping_signature!==undefined?x.getAllowUnknownParametersValue(r.mapping_signature):true}if(t){r.tile_actions_rows=x.getTileNavigationActionsRows(e,r.editable)}else if(!r.actions){r.actions=x.getTileNavigationActions(e)}if(t){var d=e.bag.getBag("deprecationProperties"),_=d.getProperty("deprecation"),f=null;if(_){f=i.getText(_==="D"?"configuration.app_deprecated":"configuration.app_archived",[d.getProperty("successor")])}r.deprecation_text=f}return r};x.getDataToDisplay=function(e,t){var a=0,i,n,r,s,l={display_icon_url:t.icon||e.display_icon_url||"",display_title_text:t.title||e.display_title_text||"",display_number_value:!isNaN(t.number)?t.number:"...",display_number_unit:t.numberUnit||e.display_number_unit||"",display_info_text:t.info||e.display_info_text||"",display_info_state:t.infoState||"Neutral",display_subtitle_text:t.subtitle||e.display_subtitle_text||"",display_state_arrow:t.stateArrow||"None",display_number_state:t.numberState||"None",display_number_digits:t.numberDigits>=0?t.numberDigits:4,display_number_factor:t.numberFactor||"",display_search_keyword:t.keywords||e.display_search_keyword||"",targetParams:[]};if(t.infoStatus){l.display_info_state=t.infoStatus}if(t.targetParams){l.targetParams.push(t.targetParams)}if(t.results){for(i=0,n=t.results.length;i<n;i=i+1){r=t.results[i].number||0;if(typeof r==="string"){r=parseFloat(r)}a=a+r;s=t.results[i].targetParams;if(s){l.targetParams.push(s)}}l.display_number_value=a}if(!isNaN(t.number)){if(typeof t.number==="string"){t.number=t.number.trim()}if(t.number===""){l.display_number_value="..."}else{var o=this._shouldProcessDigits(t.number,t.numberDigits),u=l.display_icon_url?4:5;if(t.number&&t.number.toString().length>=u||o){var p=this._normalizeNumber(t.number,u,t.numberFactor,t.numberDigits);l.display_number_factor=p.numberFactor;l.display_number_value=p.displayNumber}else{var c=m.getFloatInstance({maxFractionDigits:u});l.display_number_value=c.format(t.number)}}}if(l&&l.display_number_state){switch(l.display_number_state){case"Positive":l.display_number_state="Good";break;case"Negative":l.display_number_state="Error";break}}return l};x._normalizeNumber=function(e,t,a,i){var n;if(isNaN(e)){n=e}else{var r=m.getFloatInstance({maxFractionDigits:i});if(!a){var s=Math.abs(e);if(s>=1e9){a="B";e/=1e9}else if(s>=1e6){a="M";e/=1e6}else if(s>=1e3){a="K";e/=1e3}}n=r.format(e)}var l=n;var o=l[t-1];t-=o==="."||o===","?1:0;l=l.substring(0,t);return{displayNumber:l,numberFactor:a}};x._shouldProcessDigits=function(e,t){var a;e=typeof e!=="string"?e.toString():e;if(e.indexOf(".")!==-1){a=e.split(".")[1].length;if(a>t){return true}}return false};x.getTileSettingsAction=function(e,t,a){var i=x.getResourceBundleModel().getResourceBundle();var r=!a||a==="tile"?"tileSettingsBtn":"linkSettingsBtn";return{id:r,text:i.getText(r),press:function(){return new Promise(function(r){sap.ui.require(["sap/m/Button","sap/m/Dialog","sap/ui/core/mvc/View","sap/ui/layout/form/SimpleForm","sap/ui/layout/form/SimpleFormLayout"],function(s,l,o,u,p){var c={showGroupSelection:false,title:e.getProperty("/config/display_title_text"),subtitle:e.getProperty("/config/display_subtitle_text")};if(!a||a==="tile"){c.info=e.getProperty("/config/display_info_text");c.icon=e.getProperty("/config/display_icon_url");c.keywords=e.getProperty("/config/display_search_keywords")}else if(a==="link"){c.showInfo=false;c.showIcon=false;c.showPreview=false}o.create({viewName:"module:sap/ushell/ui/footerbar/SaveAsTile.view"}).then(function(e){var o=new n(c);e.setModel(o);var g=new u({id:"tileSettings",layout:p.GridLayout,content:[e]}).addStyleClass("sapUshellAddBookmarkForm");var d=new s("bookmarkOkBtn",{text:i.getText("okBtn"),type:S.Emphasized,press:function(){t(e);b.close()},enabled:true});var _=new s("bookmarkCancelBtn",{text:i.getText("cancelBtn"),press:function(){b.close()}});var f=function(e){d.setEnabled(!!e.trim())};e.getTitleInput().attachLiveChange(function(){f(this.getValue())});var b=new l({id:"settingsDialog",title:!a||a==="tile"?i.getText("tileSettingsDialogTitle"):i.getText("linkSettingsDialogTitle"),contentWidth:"400px",content:g,beginButton:d,endButton:_,horizontalScrolling:false,afterClose:function(){b.destroy()}}).addStyleClass("sapContrastPlus");b.open();r(b)})})})}}};x.getSemanticNavigationUrl=function(e){var t="#"+I.trim(e.navigation_semantic_object);t+="-"+I.trim(e.navigation_semantic_action);if(e.navigation_semantic_parameters&&I.trim(e.navigation_semantic_parameters).length>0){t+="?"+I.trim(e.navigation_semantic_parameters)}return t};x.addParamsToUrl=function(e,t){var a="",i=e.indexOf("?")!==-1,n=t.targetParams,r;if(n&&n.length>0){for(r=0;r<n.length;r=r+1){a+=n[r];if(r<n.length-1){a+="&"}}}if(a.length>0){if(!i){e+="?"}else{e+="&"}e+=a}return e};return x},true);