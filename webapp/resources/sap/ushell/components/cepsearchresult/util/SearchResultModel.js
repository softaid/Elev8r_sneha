// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/base/assert","sap/ui/model/json/JSONModel","sap/ui/base/ManagedObject","sap/ui/integration/util/DataProviderFactory","sap/ui/integration/util/BindingResolver"],function(t,a,e,s,i,r){"use strict";var l=new s;var o=e.extend("sap.ushell.components.cepsearchresult.util.SearchResultModel");o.prototype.setExtension=function(t){this._extension=t};o.prototype.setHost=function(t){this._host=t};o.prototype.setCard=function(t){this._card=t};o.prototype.fetchCategoryData=function(t){var a=this.getData();a._status=a._status||{};a.list=a.list||{data:{}};a.list.data=a.list.data||{};a.list.data._result=[];a.list.data._count=0;a.list._currentView=a.list._currentView||a.list.defaultView;a._status.dataStatusText=a.list.loadingDataText;a.list.paginator.currentPage=t;a.list.paginator.skip=(a.list.paginator.currentPage-1)*a.list.paginator.pageSize;a.list.paginator.top=a.list.paginator.pageSize;this.oDataProviderFactory=new i({card:this._card,extension:this._extension,host:this._host});var s=new e(a.list.paginator);l.setModel(s,"paginator");l.setModel(this._card.getModel("parameters"),"parameters");var o=r.resolveValue(a.list.data.request,l);var n=r.resolveValue(a.list.data.extension,l);var u;if(o){u=this.oDataProviderFactory.create({request:o})}if(n){u=this.oDataProviderFactory.create({extension:n})}l.setModel(null,"paginator");l.setModel(null,"parameters");return u.getData().then(function(t){var s=new e(t);a.list.data._result=s.getProperty(a.list.data.path);a.list.data._count=s.getProperty(a.list.data.count);if(!a.list.data._result||!Array.isArray(a.list.data._result)||a.list.data._result.length===0){a._status.dataStatusText=a.list.noDataText}if(a.list.data.clientSplice){a.list.data._result.splice(0,a.list.paginator.skip);a.list.data._result.splice(a.list.paginator.top)}for(var i=0;i<a.list.data._result.length;i++){var l=r.resolveValue(a.list.data.mapping,s,a.list.data.path+"/"+i);a.list.data._result[i]=l}this.checkUpdate()}.bind(this)).catch(function(){a.list.data._result=[];a.list.data._count=0;a._status.dataStatusText=a.list.noDataText;this.checkUpdate()}.bind(this))};return o});