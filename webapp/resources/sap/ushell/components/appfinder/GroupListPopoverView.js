// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/mvc/View","sap/m/ResponsivePopover","sap/ushell/resources","sap/m/ScrollContainer","sap/ui/Device","sap/m/StandardListItem","sap/m/List","sap/m/Input","sap/m/Button","sap/ui/core/IconPool","sap/m/Bar","sap/m/Label","sap/m/DisplayListItem","sap/m/library","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,o,i,n,r,s,u,a,p,l,c,h,d,_,g,m){"use strict";var G=_.ListMode;var f=_.ListType;return t.extend("sap.ushell.components.appfinder.GroupListPopoverView",{getControllerName:function(){return"sap.ushell.components.appfinder.GroupListPopover"},createContent:function(e){this.oPopover=new o({id:"groupsPopover",placement:"Auto",title:i.i18n.getText("addTileToGroups_popoverTitle"),contentWidth:"20rem",beginButton:this._getCloseButton(),content:this._getListContainer(),afterClose:[e._afterCloseHandler,e]}).addStyleClass("sapContrastPlus");this.addDependent(this.oPopover);this.oPopover.setInitialFocus(this._getNewGroupListItem())},open:function(t){if(document.body.clientHeight-t.getDomRef().getBoundingClientRect().bottom>=310){this.oPopover.setPlacement("Bottom")}this.oPopover.openBy(t);if(this.getViewData().singleGroupSelection){this.getController()._setFooterVisibility(false)}this.deferred=e.Deferred();return this.deferred.promise()},_getListContainer:function(){if(!this._oListContainer){var e=this._getGroupList();this._oListContainer=new n({id:"popoverContainer",horizontal:false,vertical:true,content:[e],height:r.system.phone?"100%":"190px"})}return this._oListContainer},_getNewGroupInput:function(){if(!this._oNewGroupNameInput){this._oNewGroupNameInput=new a("newGroupNameInput",{type:"Text",placeholder:i.i18n.getText("new_group_name")})}return this._oNewGroupNameInput},_getNewGroupHeader:function(){if(!this._oNewGroupHeader){var e=this.getController();var t=new p({icon:l.getIconURI("nav-back"),press:[e._backButtonHandler,e],tooltip:i.i18n.getText("newGroupGoBackBtn_tooltip")});t.addStyleClass("sapUshellCatalogNewGroupBackButton");this._oNewGroupHeader=new c("oHeadBar",{contentLeft:[t],contentMiddle:[new h({text:i.i18n.getText("newGroup_popoverTitle")})]})}return this._oNewGroupHeader},_getGroupList:function(){if(!this._oGroupList){var e=this.getController();var t=new d({label:"{oGroup/title}",selected:"{selected}",tooltip:"{oGroup/title}",type:f.Active});var o=[new g("oGroup/isGroupLocked",m.EQ,false)];var i=this.getViewData();if(i.enableHideGroups){o.push(new g("oGroup/isGroupVisible",m.EQ,true))}this._oGroupList=new u({mode:i.singleGroupSelection?G.SingleSelectMaster:G.MultiSelect,items:{path:"/userGroupList",template:t,filters:o,templateShareable:false},itemPress:[e._groupListItemClickHandler,e]});var n=this._getNewGroupListItem();this._oGroupList.addEventDelegate({onBeforeRendering:function(){this._oGroupList.insertAggregation("items",n,0,true)}.bind(this),onAfterRendering:function(){this._oGroupList.removeAggregation("items",n,true)}.bind(this)})}return this._oGroupList},_getNewGroupListItem:function(){if(!this._oNewGroupItem){this._oNewGroupItem=new s("newGroupItem",{title:i.i18n.getText("newGroup_listItemText"),type:f.Navigation});this._oNewGroupItem.data("newGroupItem",true);this._oNewGroupItem.getList=function(){return this._oGroupList}.bind(this);this._oNewGroupItem.getModeControl=function(){return null};this._oNewGroupItem.onsapspace=function(e){e.preventDefault();e.isMarked()};this._oNewGroupItem.addEventDelegate({onsaptabnext:function(e){e.preventDefault();e._bIsStopHandlers=true;this._getCloseButton().focus()}})}return this._oNewGroupItem},_getCancelButton:function(){if(!this._oCancelButton){var e=this.getController();this._oCancelButton=new p("cancelButton",{press:[e._cancelButtonPress,e],text:i.i18n.getText("cancelBtn")})}return this._oCancelButton},_getCloseButton:function(){if(!this._oCloseButton){var e=this.getController();this._oCloseButton=new p("closeButton",{press:[e._okayCancelButtonPress,e],text:i.i18n.getText("closeBtn")})}return this._oCloseButton}})});